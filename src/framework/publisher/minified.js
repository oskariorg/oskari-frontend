Oskari.clazz.define("Oskari.mapframework.bundle.publisher.PublisherBundleInstance",function(){this.sandbox=null,this.started=!1,this.plugins={},this.localization=null,this.publisher=null,this.disabledLayers=null},{__name:"Publisher",getName:function(){return this.__name},getSandbox:function(){return this.sandbox},getLocalization:function(e){return this._localization||(this._localization=Oskari.getLocalization(this.getName())),e?this._localization[e]:this._localization},start:function(){var e=this,t=e.conf,n=(t?t.sandbox:null)||"sandbox",r=Oskari.getSandbox(n),i,s;if(e.started)return;e.started=!0,e.sandbox=r,this.localization=Oskari.getLocalization(this.getName()),r.register(e);for(s in e.eventHandlers)e.eventHandlers.hasOwnProperty(s)&&r.registerForEventByName(e,s);i=r.getRequestBuilder("userinterface.AddExtensionRequest")(this),r.request(this,i),e._createUi(),e.publishMapEditorRequestHandler=Oskari.clazz.create("Oskari.mapframework.bundle.publisher.request.PublishMapEditorRequestHandler",e),r.addRequestHandler("Publisher.PublishMapEditorRequest",e.publishMapEditorRequestHandler)},init:function(){return null},update:function(){},onEvent:function(e){var t=this.eventHandlers[e.getName()];if(!t)return;return t.apply(this,[e])},eventHandlers:{AfterMapLayerRemoveEvent:function(e){jQuery("#contentMap")&&jQuery("#contentMap").hasClass("mapPublishMode")&&this.plugins["Oskari.userinterface.Flyout"].handleLayerSelectionChanged()},AfterMapLayerAddEvent:function(e){jQuery("#contentMap")&&jQuery("#contentMap").hasClass("mapPublishMode")&&this.plugins["Oskari.userinterface.Flyout"].handleLayerSelectionChanged()},MapLayerEvent:function(e){jQuery("#contentMap")&&jQuery("#contentMap").hasClass("mapPublishMode")&&this.plugins["Oskari.userinterface.Flyout"].handleLayerSelectionChanged()},"Publisher.MapPublishedEvent":function(e){var t=this.getLocalization(),n=Oskari.clazz.create("Oskari.userinterface.component.Popup"),r=n.createCloseButton(t.BasicView.buttons.ok),i,s,o,u;r.addClass("primary"),i=this.sandbox.getLocalizedProperty(this.conf.publishedMapUrl)+e.getId(),s='<iframe src="'+i+'" width="'+e.getWidth()+'" height="'+e.getHeight()+'"></iframe>',o='<textarea rows="3" cols="80">'+s+"</textarea>",u=t.published.desc+"<br/>"+o,n.show(t.published.title,u,[r]),this.setPublishMode(!1)},"Publisher.ToolStyleChangedEvent":function(e){if(!this.publisher)return;this.publisher.changeToolStyles(e.getStyle())},"Publisher.ColourSchemeChangedEvent":function(e){if(!this.publisher)return;this.publisher.changeColourScheme(e.getColourScheme())},"Publisher.FontChangedEvent":function(e){if(!this.publisher)return;this.publisher.changeFont(e.getFont())},MapLayerVisibilityChangedEvent:function(e){this.publisher&&this.publisher.maplayerPanel.handleLayerVisibilityChanged(e.getMapLayer(),e.isInScale(),e.isGeometryMatch())}},stop:function(){var e=this.sandbox(),t,n;for(n in this.eventHandlers)this.eventHandlers.hasOwnProperty(n)&&e.unregisterFromEventByName(this,n);t=e.getRequestBuilder("userinterface.RemoveExtensionRequest")(this),e.request(this,t),this.sandbox.unregister(this),this.started=!1},startExtension:function(){this.plugins["Oskari.userinterface.Flyout"]=Oskari.clazz.create("Oskari.mapframework.bundle.publisher.Flyout",this),this.plugins["Oskari.userinterface.Tile"]=Oskari.clazz.create("Oskari.mapframework.bundle.publisher.Tile",this)},stopExtension:function(){this.plugins["Oskari.userinterface.Flyout"]=null,this.plugins["Oskari.userinterface.Tile"]=null},getPlugins:function(){return this.plugins},getTitle:function(){return this.getLocalization("title")},getDescription:function(){return this.getLocalization("desc")},_createUi:function(){var e=this;e.plugins["Oskari.userinterface.Flyout"].createUi(),e.plugins["Oskari.userinterface.Tile"].refresh()},setPublishMode:function(e,t,n){var r=this,i=jQuery("#contentMap"),s,o,u,a,f,l;s=r.sandbox.findAllSelectedMapLayers(),o=null;for(u=0;u<s.length;u+=1){a=s[u];if(a.getLayerType()==="stats"){f=r.sandbox.getRequestBuilder("StatsGrid.StatsGridRequest")(!1,a),r.sandbox.request(r.getName(),f),o=a;break}}e==1?(r.disabledLayers=t,r.oskariLang=Oskari.getLang(),r._removeLayers(),i.addClass("mapPublishMode"),f=r.sandbox.getRequestBuilder("userinterface.UpdateExtensionRequest")(r,"close",r.getName()),r.sandbox.request(r.getName(),f),r.publisher=Oskari.clazz.create("Oskari.mapframework.bundle.publisher.view.BasicPublisher",r,r.getLocalization("BasicView"),n),r.publisher.render(i),r.publisher.setEnabled(!0),o&&r.publisher.initGrid(o)):(jQuery("#contentMap").width(""),jQuery(".oskariui-left").css({width:"",height:"100%","float":""}).removeClass("published-grid-left").empty(),jQuery(".oskariui-center").css({width:"100%","float":""}).removeClass("published-grid-center"),Oskari.setLang(r.oskariLang),r.publisher&&(r.publisher.setEnabled(!1),r.publisher.destroy()),i.removeClass("mapPublishMode"),r._addLayers()),l=r.sandbox.getRequestBuilder("MapFull.MapResizeEnabledRequest"),l&&(f=l(!e),r.sandbox.request(r,f))},_addLayers:function(){var e=this,t=this.sandbox,n=t.getRequestBuilder("AddMapLayerRequest"),r,i;if(e.disabledLayers)for(r=0;r<e.disabledLayers.length;r+=1)i=e.disabledLayers[r],t.request(e,n(i.getId(),!0))},_removeLayers:function(){var e=this,t=e.sandbox,n=t.getRequestBuilder("RemoveMapLayerRequest"),r,i;if(e.disabledLayers)for(r=0;r<e.disabledLayers.length;r+=1)i=e.disabledLayers[r],t.request(e,n(i.getId()))},hasPublishRight:function(e){return e.getPermission("publish")==="publication_permission_ok"},getLayersWithoutPublishRights:function(){var e=[],t=this.sandbox.findAllSelectedMapLayers(),n,r;for(n=0;n<t.length;n+=1)r=t[n],!this.hasPublishRight(r)&&r.getId().toString().indexOf("myplaces_")<0&&e.push(r);return e}},{protocol:["Oskari.bundle.BundleInstance","Oskari.mapframework.module.Module","Oskari.userinterface.Extension"]}),define("bundles/framework/bundle/publisher/instance",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.publisher.Flyout",function(e){this.instance=e,this.container=null,this.state=null,this.template=null,this.view=null},{getName:function(){return"Oskari.mapframework.bundle.publisher.Flyout"},setEl:function(e,t,n){this.container=e[0],jQuery(this.container).hasClass("publisher")||jQuery(this.container).addClass("publisher")},startPlugin:function(){this.template=jQuery("<div></div>")},stopPlugin:function(){},getTitle:function(){return this.instance.getLocalization("flyouttitle")},getDescription:function(){return this.instance.getLocalization("desc")},getOptions:function(){},setState:function(e){this.state=e},createUi:function(){var e=this,t=jQuery(this.container),n=e.instance.getSandbox();t.empty(),n.getUser().isLoggedIn()?this.view=Oskari.clazz.create("Oskari.mapframework.bundle.publisher.view.StartView",this.instance,this.instance.getLocalization("StartView")):this.view=Oskari.clazz.create("Oskari.mapframework.bundle.publisher.view.NotLoggedIn",this.instance,this.instance.getLocalization("NotLoggedView")),this.view.render(t)},handleLayerSelectionChanged:function(){this.view&&this.view.handleLayerSelectionChanged&&(this.view.handleLayerSelectionChanged(),this.instance.publisher&&this.instance.publisher.maplayerPanel.handleLayerSelectionChanged())}},{protocol:["Oskari.userinterface.Flyout"]}),define("bundles/framework/bundle/publisher/Flyout",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.publisher.Tile",function(e){this.instance=e,this.container=null,this.template=null},{getName:function(){return"Oskari.mapframework.bundle.publisher.Tile"},setEl:function(e,t,n){this.container=jQuery(e)},startPlugin:function(){this.refresh()},stopPlugin:function(){this.container.empty()},getTitle:function(){return this.instance.getLocalization("title")},getDescription:function(){return this.instance.getLocalization("desc")},getOptions:function(){},setState:function(e){},refresh:function(){}},{protocol:["Oskari.userinterface.Tile"]}),define("bundles/framework/bundle/publisher/Tile",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.publisher.event.MapPublishedEvent",function(e,t,n,r){this._id=e,this._width=t,this._height=n,this._language=r},{__name:"Publisher.MapPublishedEvent",getName:function(){return this.__name},getId:function(){return this._id},getWidth:function(){return this._width},getHeight:function(){return this._height},getLanguage:function(){return this._language}},{protocol:["Oskari.mapframework.event.Event"]}),define("bundles/framework/bundle/publisher/event/MapPublishedEvent",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.publisher.event.ToolStyleChangedEvent",function(e){this._style=e},{__name:"Publisher.ToolStyleChangedEvent",getName:function(){return this.__name},getStyle:function(){return this._style}},{protocol:["Oskari.mapframework.event.Event"]}),define("bundles/framework/bundle/publisher/event/ToolStyleChangedEvent",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.publisher.event.ColourSchemeChangedEvent",function(e){this._colourScheme=e},{__name:"Publisher.ColourSchemeChangedEvent",getName:function(){return this.__name},getColourScheme:function(){return this._colourScheme}},{protocol:["Oskari.mapframework.event.Event"]}),define("bundles/framework/bundle/publisher/event/ColourSchemeChangedEvent",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.publisher.event.FontChangedEvent",function(e){this._font=e},{__name:"Publisher.FontChangedEvent",getName:function(){return this.__name},getFont:function(){return this._font}},{protocol:["Oskari.mapframework.event.Event"]}),define("bundles/framework/bundle/publisher/event/FontChangedEvent",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.publisher.view.NotLoggedIn",function(e,t){this.instance=e,this.template=jQuery("<div class='notLoggedIn'></div>"),this.loginTemplate=jQuery("<div class='notLoggedIn'><a></a></div>"),this.registerTemplate=jQuery("<div class='notLoggedIn'><a></a></div>"),this.loc=t},{render:function(e){var t=this,n=t.instance.conf,r=t.instance.getSandbox(),i=t.template.clone(),s=t.loginTemplate.clone(),o=null,u=t.registerTemplate.clone(),a=null,f=s.find("a"),l=u.find("a");n&&(o=r.getLocalizedProperty(n.loginUrl),a=r.getLocalizedProperty(n.registerUrl)),i.append(t.loc.text),e.append(i),o&&(f.attr("href",o),f.append(t.loc.signup),e.append(s)),a&&(l.attr("href",a),l.append(t.loc.register),e.append(u))}}),define("bundles/framework/bundle/publisher/view/NotLoggedIn",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.publisher.view.StartView",function(e,t){this.instance=e,this.template=jQuery("<div class='startview'><div class='content'></div><div class='tou'><a href='JavaScript:void(0;)'></a></div><div class='buttons'></div></div>"),this.templateLayerList=jQuery("<div class='layerlist'><h4></h4><ul></ul></div>"),this.templateListItem=jQuery("<li></li>"),this.templateError=jQuery('<div class="error"><ul></ul></div>'),this.templateInfo=jQuery("<div class='icon-info'></div>"),this.loc=t,this.content=undefined,this.buttons={},this.hasAcceptedTou=!1},{render:function(e){var t=this,n=this.template.clone();this.content=n,n.find("div.content").before(this.loc.text),e.append(n);var r=n.find("div.tou a");r.append(this.loc.touLink),r.bind("click",function(){return t._showTermsOfUse(),!1});var i=Oskari.clazz.create("Oskari.userinterface.component.Button");i.addClass("primary"),i.setHandler(function(){t.hasAcceptedTou||t._markTouAccepted();var e=t.instance.getLayersWithoutPublishRights();t.instance.setPublishMode(!0,e)}),this.buttons["continue"]=i,this._updateContinueButton(),i.insertTo(n.find("div.buttons"));var s=Oskari.clazz.create("Oskari.userinterface.component.Button");s.setTitle(this.loc.buttons.cancel),s.setHandler(function(){t.instance.sandbox.postRequestByName("userinterface.UpdateExtensionRequest",[t.instance,"close"])}),this.buttons.cancel=s,s.insertTo(n.find("div.buttons")),this._renderLayerLists(),this._checkTouAccepted()},_renderLayerLists:function(){var e=this.content.find("div.content"),t=[],n=[],r=this.instance.sandbox.findAllSelectedMapLayers(),i,s,o,u,a;e.find("div.error").remove(),e.find("div.layerlist").remove();for(i=0;i<r.length;++i)s=r[i],!this.instance.hasPublishRight(s)&&s.getId().toString().indexOf("myplaces_")<0?n.push(s):t.push(s);if(t.length>0){o=this._getRenderedLayerList(t),u=o.find("h4"),a="loc.layerlist_title",this.loc&&this.loc.layerlist_title&&(a=this.loc.layerlist_title),u.append(a),e.append(o),this.buttons["continue"].setEnabled(!0);if(n.length>0){var f=this._getRenderedLayerList(n);u=f.find("h4"),u.append(this.loc.layerlist_denied);var l=this.templateInfo.clone();l.attr("title",this.loc.denied_tooltip),u.before(l),e.append(f)}}else{var c=this.templateError.clone(),h=this.templateListItem.clone();h.append(this.loc.layerlist_empty),c.find("ul").append(h),e.append(c),this.buttons["continue"].setEnabled(!1)}},_getRenderedLayerList:function(e){var t=this.templateLayerList.clone(),n=t.find("ul"),r,i,s;for(r=0;r<e.length;++r)i=e[r],s=this.templateListItem.clone(),i.getId().toString().indexOf("myplaces_")>-1?s.append(i.getName()+" ("+this.loc.myPlacesDisclaimer+")"):s.append(i.getName()),n.append(s);return t},handleLayerSelectionChanged:function(){this._renderLayerLists()},_showTermsOfUse:function(){var e=this;if(!this.termsOfUse){var t=Oskari.clazz.create("Oskari.userinterface.component.UIHelper",e.instance.sandbox);t.getHelpArticle("termsofuse, mappublication, "+Oskari.getLang(),function(t,n){t&&(e.termsOfUse=n,e._showTermsOfUse())});return}var n=Oskari.clazz.create("Oskari.userinterface.component.Popup"),r=n.createCloseButton(this.loc.buttons.close);n.show(e.termsOfUse.title,e.termsOfUse.body,[r])},_checkTouAccepted:function(){var e=this;jQuery.ajax({url:e.instance.sandbox.getAjaxUrl(),type:"GET",data:{action_route:"HasAcceptedPublishedTermsOfUse"},dataType:"json",error:function(){this.success(!1)},beforeSend:function(e){e&&e.overrideMimeType&&e.overrideMimeType("application/j-son;charset=UTF-8")},success:function(t){e.hasAcceptedTou=t,e._updateContinueButton()}})},_updateContinueButton:function(){this.hasAcceptedTou?this.buttons["continue"].setTitle(this.loc.buttons["continue"]):this.buttons["continue"].setTitle(this.loc.buttons.continueAndAccept)},_markTouAccepted:function(){var e=this;jQuery.ajax({url:e.instance.sandbox.getAjaxUrl(),type:"GET",data:{action_route:"AcceptPublishedTermsOfUse"},dataType:"json",error:function(){this.success(!1)},beforeSend:function(e){e&&e.overrideMimeType&&e.overrideMimeType("application/j-son;charset=UTF-8")},success:function(t){e.hasAcceptedTou=t,e._updateContinueButton()}})}}),define("bundles/framework/bundle/publisher/view/StartView",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.publisher.view.BasicPublisher",function(e,t,n){var r=this;r.data=n,r.instance=e,r.template=jQuery('<div class="basic_publisher"><div class="header"><div class="icon-close"></div><h3></h3></div><div class="content"></div></div>'),r.templates={publishedGridTemplate:'<div class="publishedgrid"></div>'},r.templateButtonsDiv=jQuery('<div class="buttons"></div>'),r.templateHelp=jQuery('<div class="help icon-info"></div>'),r.templateTool=jQuery('<div class="tool "><input type="checkbox"/><span></span></div>'),r.templateToolOptions=jQuery('<div class="tool-options"></div>'),r.templateToolOption=jQuery('<div class="tool-option"><input type="checkbox" /><span></span></div>'),r.templateLayout=jQuery('<div class="tool "><label><input type="radio" name="toolLayout" /><span></span></label></div>'),r.templateData=jQuery('<div class="data "><input type="checkbox"/><label></label></div>'),r.templateSizeOptionTool=jQuery('<div class="tool "><input type="radio" name="size" /><span></span></div>'),r.templateCustomSize=jQuery('<div class="customsize"><input type="text" name="width" placeholder="'+t.sizes.width+'"/> x '+'<input type="text" name="height" placeholder="'+t.sizes.height+'"/></div>'),r.tools=[{id:"Oskari.mapframework.bundle.mapmodule.plugin.ScaleBarPlugin",selected:!1,lefthanded:"bottom left",righthanded:"bottom right",config:{location:{top:"",right:"",bottom:"",left:"",classes:"bottom left"}}},{id:"Oskari.mapframework.bundle.mapmodule.plugin.IndexMapPlugin",selected:!1,lefthanded:"bottom right",righthanded:"bottom left",config:{location:{top:"",right:"",bottom:"",left:"",classes:"bottom right"}}},{id:"Oskari.mapframework.bundle.mapmodule.plugin.PanButtons",selected:!1,lefthanded:"top left",righthanded:"top right",config:{location:{top:"",right:"",bottom:"",left:"",classes:"top left"}}},{id:"Oskari.mapframework.bundle.mapmodule.plugin.Portti2Zoombar",selected:!0,lefthanded:"top left",righthanded:"top right",config:{location:{top:"",right:"",bottom:"",left:"",classes:"top left"}}},{id:"Oskari.mapframework.bundle.mapmodule.plugin.SearchPlugin",selected:!1,lefthanded:"top right",righthanded:"top left",config:{location:{top:"",right:"",bottom:"",left:"",classes:"top right"}}},{id:"Oskari.mapframework.bundle.mapmodule.plugin.PublisherToolbarPlugin",selected:!1,lefthanded:"top right",righthanded:"top left",config:{location:{top:"",right:"",bottom:"",left:"",classes:"top right"},toolbarId:"PublisherToolbar"}},{id:"Oskari.mapframework.mapmodule.ControlsPlugin",selected:!0},{id:"Oskari.mapframework.mapmodule.GetInfoPlugin",selected:!0,config:{infoBox:!0}}],r.toolIndices={};var i;for(i=r.tools.length-1;i>-1;i-=1)r.toolIndices[this.tools[i].id]=i;r.logoPluginClasses={lefthanded:"bottom left",righthanded:"bottom right",classes:"bottom left"},r.layerSelectionClasses={lefthanded:"top right",righthanded:"top left",classes:"top right"},r.toolbarConfig={},r.toolLayouts=["lefthanded","righthanded"],r.sizeOptions=[{id:"small",width:580,height:387},{id:"medium",width:700,height:525,selected:!0},{id:"large",width:1240,height:700},{id:"custom",minWidth:30,minHeight:20,maxWidth:4e3,maxHeight:2e3}],r.grid={},r.grid.selected=!0;if(n){n.lang&&Oskari.setLang(n.lang);var s=!1,o=r.data.state.mapfull.config.size.width,u=r.data.state.mapfull.config.size.height,a;for(i=0;i<r.sizeOptions.length;i+=1)a=r.sizeOptions[i],o===a.width&&u===a.height?(a.selected=!0,s=!0):a.selected=!1;if(!s){var f=r.sizeOptions[r.sizeOptions.length-1];f.selected=!0,f.width=o,f.height=u}var l=r.data.state.mapfull.config.plugins,c=[],h,p;for(i=0;i<l.length;i+=1)c[l[i].id]=!0,l[i].id==="Oskari.mapframework.bundle.mapmodule.plugin.LayerSelectionPlugin"&&(r.data.hasLayerSelectionPlugin=l[i].config);r.data.hasLayerSelectionPlugin=!1;for(i=0;i<r.tools.length;i+=1)a=r.tools[i],a.selected=!!c[a.id]}r.loc=t,r.accordion=null,r.maplayerPanel=null,r.mainPanel=null,r.normalMapPlugins=[],r.logoPlugin=Oskari.clazz.create("Oskari.mapframework.bundle.mapmodule.plugin.LogoPlugin",{location:{classes:r.logoPluginClasses.classes}}),r.latestGFI=null,r.urlBase=e.conf.urlPrefix+"/web/"},{render:function(e){var t=this,n=t.template.clone();t.mainPanel=n,e.append(n);var r=n.find("div.content"),i=Oskari.clazz.create("Oskari.userinterface.component.Accordion");t.accordion=i;var s=Oskari.clazz.create("Oskari.mapframework.bundle.publisher.view.PublisherLocationForm",t.loc,t);t.locationForm=s,t.data?(n.find("div.header h3").append(t.loc.titleEdit),s.init({domain:t.data.domain,name:t.data.name,lang:t.data.lang})):(n.find("div.header h3").append(t.loc.title),s.init());var o=s.getPanel();o.open(),i.addPanel(o);var u=t.instance.getSandbox(),a=u.findAllSelectedMapLayers(),f=!1,l,c;for(l=0;l<a.length;l+=1)c=a[l],c.getLayerType()==="stats"&&(f=!0);if(f){var h=u.findRegisteredModuleInstance("MainMapModule");t.mapModule=h,t.statsContainer=jQuery(t.templates.publishedGridTemplate);var p=t._createDataPanel();p.open(),i.addPanel(p)}i.addPanel(t._createSizePanel()),i.addPanel(t._createToolsPanel()),i.addPanel(t._createToolLayoutPanel()),t.maplayerPanel=Oskari.clazz.create("Oskari.mapframework.bundle.publisher.view.PublisherLayerForm",t.loc,t.instance,{location:{classes:t.layerSelectionClasses.classes}}),t.maplayerPanel.init(),t.layoutPanel=Oskari.clazz.create("Oskari.mapframework.bundle.publisher.view.PublisherLayoutForm",t.loc,t);var d=t._getInitialLayoutData(t.data);t.layoutPanel.init(d),i.addPanel(t.layoutPanel.getPanel()),i.addPanel(t.maplayerPanel.getPanel()),i.insertTo(r),e.find("div.header div.icon-close").bind("click",function(){t.instance.setPublishMode(!1)}),r.append(t._getButtons());var v=t.mainPanel.find("input[type=text]");v.focus(function(){t.instance.sandbox.postRequestByName("DisableMapKeyboardMovementRequest")}),v.blur(function(){t.instance.sandbox.postRequestByName("EnableMapKeyboardMovementRequest")});var m=Oskari.clazz.create("Oskari.userinterface.component.UIHelper",t.instance.sandbox);m.processHelpLinks(t.loc.help,n,t.loc.error.title,t.loc.error.nohelp)},_setSelectedSize:function(){var e=this,t=this.mainPanel.find("div.customsize input[name=width]");t.removeClass("error");var n=this.mainPanel.find("div.customsize input[name=height]");n.removeClass("error");var r=this.instance.sandbox.findRegisteredModuleInstance("MainMapModule"),i,s,o;for(i=0;i<e.sizeOptions.length;i+=1){s=e.sizeOptions[i];if(s.selected){o=jQuery(r.getMap().div);if(s.id==="custom"){var u=t.val();this._validateNumberRange(u,s.minWidth,s.maxWidth)?(o.width(u),e.adjustDataContainer()):t.addClass("error");var a=n.val();this._validateNumberRange(a,s.minHeight,s.maxHeight)?o.height(a):n.addClass("error");break}o.width(s.width),o.height(s.height),e.adjustDataContainer();break}}r.updateSize()},_createSizePanel:function(){var e=this,t=Oskari.clazz.create("Oskari.userinterface.component.AccordionPanel");t.setTitle(this.loc.size.label);var n=t.getContainer(),r=this.templateHelp.clone();r.attr("title",this.loc.size.tooltip),n.append(r);var i=function(t){return function(){var r=n.find("input[name=size]:checked").val(),i;for(i=0;i<e.sizeOptions.length;i+=1)e.sizeOptions[i].selected=!1;t.selected=!0,e._setSelectedSize()}},s=!1,o,u,a,f;for(o=0;o<this.sizeOptions.length;o+=1)u=this.sizeOptions[o],a=this.templateSizeOptionTool.clone(),f=this.loc.sizes[u.id],u.width&&u.height&&"custom"!==u.id&&(f=e._getSizeLabel(f,u)),a.find("span").addClass("sizeoption_"+u.id).append(f),u.selected&&(a.find("input").attr("checked","checked"),"custom"===u.id&&(s=!0)),n.append(a),a.find("input").attr("value",u.id),a.find("input").change(i(u));var l=this.templateCustomSize.clone(),c=l.find("input");c.focus(function(){var e=n.find("input[name=size][value=custom]");e.attr("checked","checked"),e.trigger("change")}),c.bind("keyup",function(){e._setSelectedSize()});if(s){var h=l.find("input[name=width]");h.val(u.width);var p=l.find("input[name=height]");p.val(u.height)}return n.append(l),t},_getSizeLabel:function(e,t){var n=this.isDataVisible?this._calculateGridWidth():0;return e+" ("+(t.width+n)+" x "+t.height+"px)"},_setSizeLabels:function(){var e,t,n,r;for(e=0;e<this.sizeOptions.length;e+=1)t=this.sizeOptions[e],n=jQuery("span.sizeoption_"+t.id),r=this.loc.sizes[t.id],t.width&&t.height&&"custom"!==t.id&&(r=this._getSizeLabel(r,t)),n.text(r)},_createToolsPanel:function(){var e=this,t=Oskari.clazz.create("Oskari.userinterface.component.AccordionPanel");t.setTitle(this.loc.tools.label);var n=t.getContainer(),r=this.templateHelp.clone(),i,s,o,u;r.attr("title",this.loc.tools.tooltip),n.append(r);var a=function(t){return function(){var n=jQuery(this),r=n.is(":checked");t.selected=r,e._activatePreviewPlugin(t,r)}};for(i=0;i<this.tools.length;i+=1){s=this.templateTool.clone();var f=this.tools[i];o=f.id,o=o.substring(o.lastIndexOf(".")+1),u=this.loc.tools[o],s.find("span").append(u),f.selected&&s.find("input").attr("checked","checked"),f.publisherPluginContainer=s,n.append(s),s.find("input").change(a(f))}return t},_changeToolLayout:function(e){var t=this,n=t.tools,r,i;for(r=n.length-1;r>-1;r-=1)i=n[r],i[e]&&(i.config.location.classes=i[e],i.plugin&&i.plugin.setLocation&&i.plugin.setLocation(i.config.location));t.logoPluginClasses.classes=t.logoPluginClasses[e],t.logoPlugin&&t.logoPlugin.setLocation(t.logoPluginClasses),t.layerSelectionClasses.classes=t.layerSelectionClasses[e],t.maplayerPanel.plugin.setLocation(t.layerSelectionClasses)},_createToolLayoutPanel:function(){var e=this,t=Oskari.clazz.create("Oskari.userinterface.component.AccordionPanel"),n=t.getContainer(),r=e.templateHelp.clone(),i,s,o,u=function(){this.checked&&e._changeToolLayout(this.value)};t.setTitle(this.loc.toollayout.label),r.attr("title",this.loc.toollayout.tooltip),n.append(r);for(i=0;i<e.toolLayouts.length;i+=1)o=e.templateLayout.clone(),s=o.find("input"),s.val(e.toolLayouts[i]).change(u),i===0&&s.attr("checked","checked"),o.find("span").html(this.loc.toollayout[e.toolLayouts[i]]||e.toolLayouts[i]),n.append(o);return t},_createDataPanel:function(){var e=this,t=Oskari.clazz.create("Oskari.userinterface.component.AccordionPanel");t.setTitle(e.loc.data.label);var n=t.getContainer(),r=e.templateHelp.clone();r.attr("title",e.loc.data.tooltip),n.append(r);var i=e.templateData.clone();return i.find("input").attr("id","show-grid-checkbox").change(function(){var t=jQuery(e),n=t.is(":checked");e.isDataVisible=n,e.adjustDataContainer(),e._setSizeLabels()}),i.find("label").attr("for","show-grid-checkbox").append(e.loc.data.grid),e.grid.selected&&(i.find("input").attr("checked","checked"),e.isDataVisible=e.grid.selected,e.adjustDataContainer()),n.append(i),t},adjustDataContainer:function(){if(!this.statsContainer)return;var e=this,t=jQuery("#contentMap"),n=t.width(),r=t.css("margin-left").split("px")[0],i=jQuery(window).width()-r-40,s=jQuery("#mapdiv").width(),o=jQuery("#mapdiv").height(),u=e._calculateGridWidth(),a=o,f=jQuery(".oskariui-left"),l=jQuery(".oskariui-center");e.isDataVisible?(u>400&&(u=400),f.removeClass("oskari-closed"),jQuery("#contentMap").width(u+s),u+="px",a+="px",s+="px"):(f.addClass("oskari-closed"),jQuery("#contentMap").width(""),u="0px",a="0px",n="100%"),f.css({width:u,height:a,"float":"left"}).addClass("published-grid-left"),l.css({width:s,"float":"left"}).addClass("published-grid-center"),e.statsContainer.height(o),e.gridPlugin&&e.gridPlugin.setGridHeight()},_calculateGridWidth:function(){var e=Oskari.getSandbox("sandbox"),t,n=e.getStatefulComponents().statsgrid;if(n&&n.state&&n.state.indicators!==null&&n.state.indicators!==undefined){var r=n.state.indicators.length+2;t=r*80}else t=160;return t+20},getDataContainer:function(){return jQuery(".oskariui-left")},addDataGrid:function(e){this.getDataContainer.html(e)},handleMapMoved:function(){var e=this.instance.sandbox.getMap(),t=e.getX(),n=e.getY(),r=e.getZoom()},_activatePreviewPlugin:function(e,t){var n=this,r=n.instance.getSandbox();if(!e.plugin&&t){var i=this.instance.sandbox.findRegisteredModuleInstance("MainMapModule");e.plugin=Oskari.clazz.create(e.id,e.config),i.registerPlugin(e.plugin)}if(!e.plugin)return;var s=function(t,i,s){return function(){var o=jQuery(this),u=o.is(":checked"),a;e.selected=u;var f=e.plugin;u?(a=r.getRequestBuilder("Toolbar.AddToolButtonRequest"),r.request(f,a(t,i,s)),n.toolbarConfig[i]||(n.toolbarConfig[i]={}),n.toolbarConfig[i][t]=!0):(a=r.getRequestBuilder("Toolbar.RemoveToolButtonRequest"),r.request(f,a(t,i,s.toolbarid)),n.toolbarConfig[i]&&delete n.toolbarConfig[i][t])}},o,u,a,f,l,c;if(t){e.plugin.startPlugin(this.instance.sandbox),e._isPluginStarted=!0,o=e.plugin.getToolOptions?e.plugin.getToolOptions():null;var h;if(o){h=n.templateToolOptions.clone(),e.publisherPluginContainer.append(h);for(u in o)if(o.hasOwnProperty(u)){a=o[u];for(f in a.buttons)a.buttons.hasOwnProperty(f)&&(l=a.buttons[f],l.selectTool=n.templateToolOption.clone(),l.selectTool.find("span").append(this.loc.toolbarToolNames[f]),l.selected&&l.selectTool.find("input").attr("checked","checked"),l.selectTool.find("input").change(s(f,a.name,l)),h.append(l.selectTool))}}}else if(e._isPluginStarted){o=e.plugin.getToolOptions?e.plugin.getToolOptions():null;if(o){for(u in o)if(o.hasOwnProperty(u)){a=o[u];for(f in a.buttons)a.buttons.hasOwnProperty(f)&&(l=a.buttons[f],c=r.getRequestBuilder("Toolbar.RemoveToolButtonRequest"),r.request(e.plugin,c(f,a.name,l.toolbarid)))}var p=e.publisherPluginContainer.find(".tool-options"),d=p.find("input").off("change",n._toggleToolOption);d.remove(),p.remove()}e._isPluginStarted=!1,e.plugin.stopPlugin(this.instance.sandbox)}},_getButtons:function(){var e=this,t=e.templateButtonsDiv.clone(),n=Oskari.clazz.create("Oskari.userinterface.component.Button");n.setTitle(e.loc.buttons.cancel),n.setHandler(function(){e.instance.setPublishMode(!1)}),n.insertTo(t);var r=Oskari.clazz.create("Oskari.userinterface.component.Button");r.setTitle(e.loc.buttons.save),r.addClass("primary");if(e.data){var i=function(){var t=e._gatherSelections();t&&e._publishMap(t)};r.setTitle(e.loc.buttons.saveNew),r.setHandler(function(){e.data.id=null,delete e.data.id,i()}),r.insertTo(t);var s=Oskari.clazz.create("Oskari.userinterface.component.Button");s.setTitle(e.loc.buttons.replace),s.addClass("primary"),s.setHandler(function(){e._showReplaceConfirm(i)}),s.insertTo(t)}else r.setTitle(e.loc.buttons.save),r.setHandler(function(){var t=e._gatherSelections();t&&e._publishMap(t)}),r.insertTo(t);return t},_showReplaceConfirm:function(e){var t=Oskari.clazz.create("Oskari.userinterface.component.Popup"),n=Oskari.clazz.create("Oskari.userinterface.component.Button");n.setTitle(this.loc.buttons.replace),n.addClass("primary"),n.setHandler(function(){t.close(),e()});var r=t.createCloseButton(this.loc.buttons.cancel);t.show(this.loc.confirm.replace.title,this.loc.confirm.replace.msg,[r,n])},_showValidationErrorMessage:function(e){var t=Oskari.clazz.create("Oskari.userinterface.component.Popup"),n=t.createCloseButton(this.loc.buttons.ok),r=jQuery("<ul></ul>"),i,s;for(i=0;i<e.length;i+=1)s=jQuery("<li></li>"),s.append(e[i].error),r.append(s);t.show(this.loc.error.title,r,[n])},_gatherSelections:function(){var e=this,t=e.mainPanel,n=e.instance.getSandbox(),r=e.locationForm.validate(),i=e.locationForm.getValues(),s=t.find("input[name=size]:checked").val(),o=e._calculateGridWidth(),u={domain:i.domain,name:i.name,language:i.language,plugins:[]},a,f,l,c,h;e.data&&e.data.id&&(u.id=e.data.id);if(e.toolbarConfig){var p=!1;for(a in e.toolbarConfig)if(e.toolbarConfig.hasOwnProperty(a)){for(f in e.toolbarConfig[a])if(e.toolbarConfig[a].hasOwnProperty(f)&&e.toolbarConfig[a][f]){p=!0;break}if(p)break}p&&(u.toolbar=e.toolbarConfig)}for(a=0;a<e.tools.length;a+=1)if(e.tools[a].selected){l={id:e.tools[a].id};if(e.tools[a].config){l.config=e.tools[a].config,l.config.location&&(l.config.location.classes?(h=l.config.location.classes,l.config.location={classes:h}):l.config.location={});for(f=0;f<e.toolLayouts.length;f+=1)l.config[e.toolLayouts[f]]=null,delete l.config[e.toolLayouts[f]]}u.plugins.push(l)}if(s==="custom"){var d=t.find("div.customsize input[name=width]").val(),v=t.find("div.customsize input[name=height]").val();e._validateSize(d,v)?u.size={width:d,height:v}:r.push({field:"size",error:this.loc.error.size})}else for(a=0;a<e.sizeOptions.length;a+=1){c=e.sizeOptions[a];if(c.id===s){u.size={width:c.width,height:c.height};break}}var m=e.maplayerPanel.getValues();m.layerSelection&&(m.layerSelection.location={classes:e.layerSelectionClasses.classes},u.plugins.push(m.layerSelection),u.defaultBase=m.defaultBase,u.baseLayers=m.baseLayers),u.plugins.push({id:"Oskari.mapframework.bundle.mapmodule.plugin.LogoPlugin",config:{location:{classes:e.logoPluginClasses.classes}}});if(e.isDataVisible){var g=e.sandbox.getStatefulComponents().statsgrid;u.gridState=g.state}var y=n.getStatefulComponents().mapfull.getState();u.mapstate=y,n.getStatefulComponents().infobox&&(u.infobox=n.getStatefulComponents().infobox.getState());if(r.length>0){e._showValidationErrorMessage(r);return}return u},_publishMap:function(e){var t=this,n=this.instance.getSandbox(),r=n.getAjaxUrl(),i=t.isDataVisible?e.size.width+t._calculateGridWidth():e.size.width,s=function(){var e=Oskari.clazz.create("Oskari.userinterface.component.Popup"),n=e.createCloseButton(t.loc.buttons.ok);e.show(t.loc.error.title,t.loc.error.saveFailed,[n])};jQuery.ajax({url:r+"&action_route=Publish",type:"POST",dataType:"json",data:{pubdata:JSON.stringify(e)},beforeSend:function(e){e&&e.overrideMimeType&&e.overrideMimeType("application/j-son;charset=UTF-8")},success:function(t){if(t.id>0){var r=n.getEventBuilder("Publisher.MapPublishedEvent")(t.id,i,e.size.height,e.language);n.notifyAll(r)}else s()},error:s})},_validateNumberRange:function(e,t,n){return isNaN(parseInt(e,10))?!1:isFinite(e)?e<t||e>n?!1:!0:!1},_validateSize:function(e,t){var n=null,r,i;for(r=0;r<this.sizeOptions.length;r+=1){i=this.sizeOptions[r];if(i.id==="custom"){n=i;break}}var s=this._validateNumberRange(e,n.minWidth,n.maxWidth)&&this._validateNumberRange(t,n.minHeight,n.maxHeight);return s},_enablePreview:function(){var e=this,t=e.instance.sandbox.findRegisteredModuleInstance("MainMapModule"),n=t.getPluginInstances(),r,i,s;for(r in n)n.hasOwnProperty(r)&&(i=n[r],i.hasUI&&i.hasUI()&&(i.stopPlugin(e.instance.sandbox),t.unregisterPlugin(i),e.normalMapPlugins.push(i)));e.maplayerPanel.start(),e.data&&e.data.hasLayerSelectionPlugin&&e.maplayerPanel.useConfig(e.data.hasLayerSelectionPlugin),e._setSelectedSize();for(s=0;s<this.tools.length;s+=1)this.tools[s].selected&&this._activatePreviewPlugin(this.tools[s],!0);t.registerPlugin(this.logoPlugin),this.logoPlugin.startPlugin(e.instance.sandbox)},_disablePreview:function(){var e=this,t=this.instance.sandbox.findRegisteredModuleInstance("MainMapModule"),n=t.getPluginInstances(),r,i;for(i=0;i<this.tools.length;i+=1)this.tools[i].plugin&&(this._activatePreviewPlugin(this.tools[i],!1),t.unregisterPlugin(this.tools[i].plugin),this.tools[i].plugin=undefined,delete this.tools[i].plugin);this.maplayerPanel.stop(),this.layoutPanel.stop();var s=jQuery(t.getMap().div);s.width(""),s.height(jQuery(window).height()),t.updateSize(),t.unregisterPlugin(this.logoPlugin),this.logoPlugin.stopPlugin(e.instance.sandbox);for(i=0;i<this.normalMapPlugins.length;i+=1)r=this.normalMapPlugins[i],t.registerPlugin(r),r.startPlugin(e.instance.sandbox);this.normalMapPlugins=[]},setEnabled:function(e){e?this._enablePreview():this._disablePreview()},destroy:function(){this.mainPanel.remove()},setPluginLanguage:function(e){Oskari.setLang(e);var t,n;for(t=0;t<this.tools.length;t+=1)n=this.tools[t],n._isPluginStarted&&(this._activatePreviewPlugin(n,!1),this._activatePreviewPlugin(n,!0));this._resetLayerSelectionPlugin(),this.logoPlugin.stopPlugin(this.instance.sandbox),this.logoPlugin.startPlugin(this.instance.sandbox)},_resetLayerSelectionPlugin:function(){if(this.maplayerPanel.isEnabled()){var e=this.maplayerPanel.plugin.getBaseLayers();this.maplayerPanel.enablePlugin(!1),this.maplayerPanel.enablePlugin(!0);var t=e.baseLayers,n=e.defaultBaseLayer,r,i;for(r=0;r<t.length;r+=1)i=this.instance.sandbox.findMapLayerFromSelectedMapLayers(t[r]),this.maplayerPanel.plugin.addBaseLayer(i);this.maplayerPanel.plugin.selectBaseLayer(n)}},initGrid:function(e){var t=this,n=t.conf,r=Oskari.getLocalization("StatsGrid"),i=!0,s="sandbox",o=Oskari.getSandbox(s);t.sandbox=o,o.register(t.instance);var u=Oskari.clazz.create("Oskari.statistics.bundle.statsgrid.StatisticsService",t);o.registerService(u),t.statsService=u;var a=t.sandbox.getStatefulComponents().statsgrid;if(a&&a.state&&i){var f={published:!0,layer:e,state:a.state},l=Oskari.clazz.create("Oskari.statistics.bundle.statsgrid.plugin.ManageStatsPlugin",f,r);t.mapModule.registerPlugin(l),t.mapModule.startPlugin(l),t.gridPlugin=l;var c=Oskari.clazz.create("Oskari.statistics.bundle.statsgrid.plugin.ManageClassificationPlugin",n,r);t.mapModule.registerPlugin(c),t.mapModule.startPlugin(c),t.classifyPlugin=c;var h=t.getDataContainer();h.html(t.statsContainer),t.gridPlugin.createStatsOut(t.statsContainer)}},changeToolStyles:function(e){if(!e)return;var t,n,r;for(n=0;n<this.tools.length;n+=1)r=this.tools[n],r.id.indexOf("Portti2Zoombar")>=0?(t=e.zoombar||{},t.val=e.val):r.id.indexOf("SearchPlugin")>=0?(t=e.search||{},t.val=e.val):t=e.val,r.config&&(r.config.toolStyle=t),r._isPluginStarted&&r.plugin.changeToolStyle&&r.plugin.changeToolStyle(t);this._setLayerSelectionStyle(e.val)},_setLayerSelectionStyle:function(e){var t=this.maplayerPanel;t.pluginConfig.toolStyle=e,t.isEnabled()&&t.plugin.changeToolStyle&&t.plugin.changeToolStyle(e)},changeColourScheme:function(e){var t=this._getGetInfoPlugin();t&&(t.config=t.config||{},t.config.colourScheme=e);var n=this.maplayerPanel;n.pluginConfig.colourScheme=e,n.isEnabled()&&n.plugin.changeColourScheme&&n.plugin.changeColourScheme(e)},changeFont:function(e){if(!e)return;var t,n;for(t=0;t<this.tools.length;t+=1)n=this.tools[t],n.config&&(n.config.font=e),n._isPluginStarted&&n.plugin.changeFont&&n.plugin.changeFont(e);this._setLayerSelectionFont(e),this.logoPlugin&&this.logoPlugin.changeFont&&this.logoPlugin.changeFont(e);var r=this._getGetInfoPlugin();r&&(r.config=r.config||{},r.config.font=e)},_setLayerSelectionFont:function(e){var t=this.maplayerPanel;t.pluginConfig.font=e,t.isEnabled()&&t.plugin.changeFont&&t.plugin.changeFont(e)},_getGetInfoPlugin:function(){var e=null,t,n;for(t=0;t<this.tools.length;t+=1){n=this.tools[t];if(n.id==="Oskari.mapframework.mapmodule.GetInfoPlugin"){e=n;break}}return e},_getInitialLayoutData:function(e){if(!e)return null;var t=e.state.mapfull.config.plugins,n=t.length,r={},i,s;for(i=0;i<n;i+=1)s=t[i],s.config&&(s.config.font&&(r.font=s.config.font),s.config.colourScheme&&(r.colourScheme=s.config.colourScheme),s.config.toolStyle&&(typeof s.config.toolStyle=="string"?r.toolStyle=s.config.toolStyle:r.toolStyle=s.config.toolStyle.val));return r}}),define("bundles/framework/bundle/publisher/view/BasicPublisher",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.publisher.view.PublisherLocationForm",function(e,t){this.loc=e,this._publisher=t,this.fields={domain:{label:e.domain.label,placeholder:e.domain.placeholder,helptags:"portti,help,publisher,domain",tooltip:e.domain.tooltip},name:{label:e.name.label,placeholder:e.name.placeholder,helptags:"portti,help,publisher,name",tooltip:e.name.tooltip}},this.langField={template:jQuery('<div class="field"><div class="help icon-info" title="'+e.language.tooltip+'" helptags="portti,help,publisher,language"></div>'+'<label for="language">'+e.language.label+'</label><br clear="all" />'+'<select name="language"></select>'+"</div>"),optionTemplate:jQuery("<option></option>")}},{init:function(e){var t=this,n,r,i;for(n in this.fields)this.fields.hasOwnProperty(n)&&(r=this.fields[n],i=Oskari.clazz.create("Oskari.userinterface.component.FormInput",n),i.getField().find("input").before("<br />"),i.setLabel(r.label),i.setTooltip(r.tooltip,r.helptags),i.setPlaceholder(r.placeholder),r.field=i);this.fields.domain.field.setRequired(!0,this.loc.error.domain),this.fields.domain.field.setContentCheck(!0,this.loc.error.domainIllegalCharacters),this.fields.domain.field.setValidator(function(e){var n=e.getValue(),r=e.getName(),i=[];return n.indexOf("http")===0||n.indexOf("www")===0?(i.push({field:r,error:t.loc.error.domainStart}),i):i}),this.fields.name.field.setRequired(!0,this.loc.error.name),this.fields.name.field.setContentCheck(!0,this.loc.error.nameIllegalCharacters),e&&(this.fields.domain.field.setValue(e.domain),this.fields.name.field.setValue(e.name));var s=this.langField.template.clone(),o=s.find("select[name=language]"),u=this.loc.language.options,a=Oskari.getLang(),f,l;e&&e.lang&&(a=e.lang);for(f in u)u.hasOwnProperty(f)&&(l=this.langField.optionTemplate.clone(),l.attr("value",f),a===f&&l.attr("selected","selected"),l.append(u[f]),o.append(l));o.change(function(){t._publisher.setPluginLanguage(jQuery(this).attr("value"))}),this.langField.field=s},getPanel:function(){var e=Oskari.clazz.create("Oskari.userinterface.component.AccordionPanel");e.setTitle(this.loc.domain.title);var t=e.getContainer(),n,r;for(n in this.fields)this.fields.hasOwnProperty(n)&&(r=this.fields[n],t.append(r.field.getField()));return t.append(this.langField.field),e},getValues:function(){var e={},t,n;for(t in this.fields)this.fields.hasOwnProperty(t)&&(n=this.fields[t],e[t]=n.field.getValue());return e.language=this.langField.field.find("select[name=language]").val(),e},validate:function(){var e=[],t,n;for(t in this.fields)this.fields.hasOwnProperty(t)&&(n=this.fields[t],e=e.concat(n.field.validate()));return e}}),define("bundles/framework/bundle/publisher/view/PublisherLocationForm",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.publisher.view.PublisherLayerForm",function(e,t,n){var r=this;r.loc=e,r.instance=t,r.panel=null,r.plugin=null,r.isDataVisible=!1,r.templateHelp=jQuery('<div class="help icon-info"></div>'),r.templateTool=jQuery('<div class="tool"><input type="checkbox"/><label></label></div>'),r.templateList=jQuery('<ul class="selectedLayersList sortable" data-sortable=\'{itemCss: "li.layer.selected", handleCss: "div.layer-title" }\'></ul>'),r.templateLayer=jQuery('<li class="layer selected"><div class="layer-info"><div class="layer-tool-remove icon-close"></div><div class="layer-title"><h4></h4></div></div><div class="layer-tools volatile"></div></li>');var i=r.instance.getLocalization("layer");r.templateLayerFooterTools=jQuery('<div class="left-tools"><div class="layer-visibility"><a href="JavaScript:void(0);">'+i.hide+"</a>"+"&nbsp;"+'<span class="temphidden" '+'style="display: none;">'+i.hidden+"</span>"+"</div>"+'<div class="oskariui layer-opacity">'+'<div class="layout-slider" id="layout-slider">'+"</div> "+'<div class="opacity-slider" style="display:inline-block">'+'<input type="text" name="opacity-slider" class="opacity-slider opacity" id="opacity-slider" />%</div>'+'</div> <br/><input class="baselayer" type="checkbox"/><label>'+i.selectAsBaselayer+"</label>"+"</div>"+'<div class="right-tools">'+'<div class="layer-rights"></div>'+'<div class="object-data"></div>'+'<div class="layer-description">'+"</div></div>"),r.templateLayerFooterHidden=jQuery('<p class="layer-msg"><a href="JavaScript:void(0);">'+i.show+"</a> "+i.hidden+"</p>"),r.templateButtonsDiv=jQuery('<div class="buttons"></div>'),r.config={layers:{promote:[{text:r.loc.layerselection.promote,id:[24]}],preselect:["base_35"]}},r.pluginConfig=n,r.pluginConfig||(r.pluginConfig={}),r.showLayerSelection=!1,r._sliders={}},{init:function(){this.panel||(this.panel=Oskari.clazz.create("Oskari.userinterface.component.AccordionPanel"),this.panel.setTitle(this.loc.layers.label)),this.plugin=Oskari.clazz.create("Oskari.mapframework.bundle.mapmodule.plugin.LayerSelectionPlugin",this.pluginConfig)},useConfig:function(e){e&&(Object.prototype.toString.call(e.baseLayers)==="[object Array]"&&e.baseLayers.length>0?this.config.layers.preselect=e.baseLayers:this.config.layers.preselect=[],this.showLayerSelection=!0,this.enablePlugin(!0),this._populateMapLayerPanel())},getPanel:function(){return this._populateMapLayerPanel(),this.panel},enablePlugin:function(e){e?(this.plugin.startPlugin(this.instance.sandbox),this.plugin.setLocation(this.plugin.conf.location)):this.isEnabled()&&this.plugin.stopPlugin(this.instance.sandbox)},isEnabled:function(){return this.showLayerSelection},start:function(){this.plugin=Oskari.clazz.create("Oskari.mapframework.bundle.mapmodule.plugin.LayerSelectionPlugin",this.pluginConfig);var e=this.instance.sandbox.findRegisteredModuleInstance("MainMapModule");e.registerPlugin(this.plugin),this.showLayerSelection&&this.enablePlugin(!0)},stop:function(){this.enablePlugin(!1);var e=this.instance.sandbox.findRegisteredModuleInstance("MainMapModule");e.unregisterPlugin(this.plugin)},getValues:function(){var e={};if(this.showLayerSelection){e.layerSelection={id:"Oskari.mapframework.bundle.mapmodule.plugin.LayerSelectionPlugin",config:this.pluginConfig};var t=this.plugin.getBaseLayers();t.defaultBaseLayer&&(e.layerSelection.config.baseLayers=t.baseLayers,e.layerSelection.config.defaultBaseLayer=t.defaultBaseLayer)}return e},validate:function(){var e=[];return e},_getLayersList:function(){var e=[],t=this.instance.sandbox.findAllSelectedMapLayers();return t},_populateMapLayerPanel:function(){var e=this,t=this.instance.getSandbox(),n=this.panel.getContainer();n.empty(),e.container=n;var r=this.templateHelp.clone();r.attr("title",this.loc.layerselection.tooltip),n.append(r);var i=this.templateTool.clone();i.find("label").attr("for","show-map-layers-checkbox").append(this.loc.layerselection.label),this.showLayerSelection&&i.find("input").attr("checked","checked"),n.append(i),n.append(this.loc.layerselection.info),i.find("input").attr("id","show-map-layers-checkbox").change(function(){var t=jQuery(this),r=t.is(":checked");e.showLayerSelection=r,e.enablePlugin(r),n.empty(),e._populateMapLayerPanel()});if(!this.showLayerSelection)return;var s=this._getLayersList(),o,u=this.templateList.clone(),a,f;for(o=0;o<s.length;o++){a=s[o];var l=this.templateLayer.clone();l.attr("data-id",a.getId()),l.find("div.layer-title h4").append(a.getName()),l.find("div.layer-title").append(a.getDescription()),a.isSticky()||(l.find("div.layer-tool-remove").addClass("icon-close"),l.find("div.layer-tool-remove").bind("click",function(n){var r="RemoveMapLayerRequest",i=t.getRequestBuilder(r),s=i(jQuery(n.currentTarget).parents(".layer").attr("data-id")),o=jQuery(n.currentTarget).parents(".layer").find(".baselayer"),u=o.is(":checked");a.selected=u,u&&e.plugin.removeBaseLayer(a),t.request(e.instance.getName(),s)})),e._appendLayerFooter(l,a,a.selected);var c=function(t){var n=jQuery.inArray(""+t,e.config.layers.preselect);return n!==-1};f=l.find("input.baselayer"),f.attr("id","checkbox"+a.getId()),c(a.getId())&&(f.attr("checked","checked"),a.selected=!0,this.plugin.addBaseLayer(a)),u.prepend(l)}n.append(u),u.sortable({stop:function(t,n){var r=n.item;e._layerOrderChanged(r)}});var h=e.templateButtonsDiv.clone(),p=Oskari.clazz.create("Oskari.userinterface.component.Button");p.setTitle(e.loc.buttons.add),p.addClass("block"),p.insertTo(h);var d=function(){e._openExtension("LayerSelector")};p.setHandler(function(){d()}),n.append(h)},_populateLayerPromotion:function(e){var t=this,n=this.instance.getSandbox(),r=n.getRequestBuilder("AddMapLayerRequest"),i=n.getRequestBuilder("RemoveMapLayerRequest"),s=function(e){return function(){var s=jQuery(this),o=s.is(":checked");o?(n.request(t.instance,r(e.getId(),!0)),t.plugin.addBaseLayer(e)):n.request(t.instance,i(e.getId()))}},o,u,a,f,l,c,h;for(o=0;o<this.config.layers.promote.length;o+=1){u=this.config.layers.promote[o],a=this._getActualPromotionLayers(u.id);if(a.length>0){e.append(u.text);for(f=0;f<a.length;f+=1)l=a[f],c=this.templateTool.clone(),c.attr("data-id",l.getId()),c.find("label").attr("for","checkbox"+l.getId()).append(l.getName()),h=c.find("input"),h.attr("id","checkbox"+l.getId()),h.change(s(l)),e.append(c)}}},_getActualPromotionLayers:function(e){var t=this.instance.getSandbox(),n=[],r,i;for(r=0;r<e.length;r+=1)t.isLayerAlreadySelected(e[r])||(i=t.findMapLayerFromAllAvailable(e[r]),i&&n.push(i));return n},handleLayerSelectionChanged:function(){this._populateMapLayerPanel()},_layerOrderChanged:function(e){var t=jQuery(this.container).find(".selectedLayersList li"),n=e.attr("data-id"),r=-1;t.each(function(e,t){return $(this).attr("data-id")===n?(r=e,!1):!0});if(r>-1){r=t.length-1-r;var i=this.instance.getSandbox(),s="RearrangeSelectedMapLayerRequest",o=i.getRequestBuilder(s),u=o(n,r);i.request(this.instance.getName(),u)}},_layerOpacityChanged:function(e,t){var n=this.instance.getSandbox(),r="ChangeMapLayerOpacityRequest",i=n.getRequestBuilder(r),s=i(e.getId(),t);n.request(this.instance.getName(),s);var o="li.layer.selected[data-id="+e.getId()+"]",u=jQuery(this.container).find(o),a=u.find("div.layer-opacity input.opacity");a.attr("value",e.getOpacity())},handleLayerVisibilityChanged:function(e,t,n){var r=this,i=r.instance.getSandbox(),s="li.layer.selected[data-id="+e.getId()+"]",o=jQuery(this.container).find(s),u=this.instance.getLocalization("layer"),a=o.find("div.layer-tools"),f=a.find(".baselayer").is(":checked");a.empty(),o.removeClass("hidden-layer"),this._sliders[e.getId()]=null,this._appendLayerFooter(o,e,f)},_createLayerFooter:function(e,t,n){var r=this,i=r.instance.getSandbox(),s=this.templateLayerFooterTools.clone(),o=this.instance.getLocalization("layer"),u="MapModulePlugin.MapLayerVisibilityRequest",a=i.getRequestBuilder(u);s.find("div.layer-visibility a").bind("click",function(){var t=a(e.getId(),!1);return i.request(r.instance.getName(),t),!1});var f=function(e){return function(){var t=jQuery(this),n=t.is(":checked");e.selected=n,n?r.plugin.addBaseLayer(e):r.plugin.removeBaseLayer(e)}},l=s.find("input.baselayer");return l.attr("id","checkbox"+e.getId()),n&&l.attr("checked","checked"),l.change(f(e)),s},_createLayerFooterHidden:function(e){var t=this,n=t.instance.getSandbox(),r=this.templateLayerFooterHidden.clone();r.addClass("layer-msg-for-hidden");var i="MapModulePlugin.MapLayerVisibilityRequest",s=n.getRequestBuilder(i);return r.find("a").bind("click",function(){var r=s(e.getId(),!0);return n.request(t.instance.getName(),r),!1}),r},_appendLayerFooter:function(e,t,n){var r=e.find("div.layer-tools"),i=this._createLayerFooter(t,e,n);t.isVisible()?i.css("display",""):(r.addClass("hidden-layer"),i.find(".layer-visibility").css("display","none"),jQuery(jQuery(i).get(0)).prepend(this._createLayerFooterHidden(t))),r.append(i);var s=this._addSlider(t,e),o=e.find("div.layer-opacity input.opacity");o.attr("value",t.getOpacity())},_addSlider:function(e,t){var n=this,r=e.getId(),i=e.getOpacity(),s=t.find(".layout-slider"),o=s.slider({min:0,max:100,value:i,slide:function(t,r){n._layerOpacityChanged(e,r.value)},stop:function(t,r){n._layerOpacityChanged(e,r.value)}});return n._sliders[r]=o,o},_getFakeExtension:function(e){return{getName:function(){return e}}},_openExtension:function(e){var t=this._getFakeExtension(e),n="userinterface.UpdateExtensionRequest";this.instance.getSandbox().postRequestByName(n,[t,"attach",n,"10","405"])}}),define("bundles/framework/bundle/publisher/view/PublisherLayerForm",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.publisher.view.PublisherLayoutForm",function(e,t){this.loc=e,this._publisher=t,this._sandbox=t.instance.sandbox,this._colourSchemePopup=null,this._customColoursPopup=null,this.template={};var n;for(n in this.__templates)this.__templates.hasOwnProperty(n)&&(this.template[n]=jQuery(this.__templates[n]));this.values=null,this.initialValues={colours:[{val:"light_grey",bgColour:"#EFF2F2",titleColour:"#333438",headerColour:"#333438",iconCls:"icon-close"},{val:"dark_grey",bgColour:"#424343",titleColour:"#FFFFFF",headerColour:"#424343",iconCls:"icon-close-white"},{val:"blue",bgColour:"#0091FF",titleColour:"#FFFFFF",headerColour:"#0091FF",iconCls:"icon-close-white"},{val:"red",bgColour:"#FF3333",titleColour:"#FFFFFF",headerColour:"#FF3333",iconCls:"icon-close-white"},{val:"green",bgColour:"#26BF4C",titleColour:"#FFFFFF",headerColour:"#48732E",iconCls:"icon-close-white"},{val:"yellow",bgColour:"#FFDE00",titleColour:"#333438",headerColour:"#333438",iconCls:"icon-close"},{val:"custom",bgColour:null,titleColour:null,headerColour:null,iconCls:"icon-close-white"}],fonts:[{name:"Arial (sans-serif)",val:"arial"},{name:"Georgia (serif)",val:"georgia"}],toolStyles:[{val:"rounded-dark",zoombar:{widthPlus:"22px",widthMinus:"22px",widthCenter:"22px",heightPlus:"38px",heightMinus:"39px",heightCenter:12,heightCursor:"18px",widthCursor:"17px"},search:{widthLeft:17,widthRight:32}},{val:"rounded-light",zoombar:{widthPlus:"22px",widthMinus:"22px",widthCenter:"22px",heightPlus:"38px",heightMinus:"39px",heightCenter:12,heightCursor:"18px",widthCursor:"17px"},search:{widthLeft:17,widthRight:32}},{val:"sharp-dark",zoombar:{widthPlus:"23px",widthMinus:"23px",widthCenter:"23px",heightPlus:"17px",heightMinus:"18px",heightCenter:16,heightCursor:"16px",widthCursor:"23px"},search:{widthLeft:5,widthRight:30}},{val:"sharp-light",zoombar:{widthPlus:"23px",widthMinus:"23px",widthCenter:"23px",heightPlus:"17px",heightMinus:"18px",heightCenter:16,heightCursor:"16px",widthCursor:"23px"},search:{widthLeft:5,widthRight:30}},{val:"3d-dark",zoombar:{widthPlus:"23px",widthMinus:"23px",widthCenter:"23px",heightPlus:"35px",heightMinus:"36px",heightCenter:13,heightCursor:"13px",widthCursor:"23px"},search:{widthLeft:5,widthRight:44}},{val:"3d-light",zoombar:{widthPlus:"23px",widthMinus:"23px",widthCenter:"23px",heightPlus:"35px",heightMinus:"36px",heightCenter:13,heightCursor:"13px",widthCursor:"23px"},search:{widthLeft:5,widthRight:44}}]},this.fields={colours:{label:this.loc.layout.fields.colours.label,getContent:this._getColoursTemplate},fonts:{label:this.loc.layout.fields.fonts.label,getContent:this._getFontsTemplate},toolStyles:{label:this.loc.layout.fields.toolStyles.label,getContent:this._getToolStylesTemplate}},this.customColourValues={bg:null,title:null,header:null,iconCsl:null},this.maxColourValue=255,this.minColourValue=0},{__templates:{colours:'<div id="publisher-layout-colours"><label for="publisher-colours"></label><div id="publisher-layout-coloursSelector"><input type="text" name="publisher-colour" disabled /><button id="publisher-colours"></button></div></div>',fonts:'<div id="publisher-layout-fonts"><label for="publisher-fonts"></label><select name="publisher-fonts"></select></div>',toolStyles:'<div id="publisher-layout-toolStyles"><label for="publisher-toolStyles"></label><select name="publisher-toolStyles"></select></div>',option:"<option></option>",inputRadio:'<div><input type="radio" /><label></label></div>',coloursPopup:'<div id="publisher-colour-popup"><div id="publisher-colour-inputs"></div><div id="publisher-colour-preview"></div></div>',customClrs:'<div id="publisher-custom-colours"><div id="publisher-custom-colours-bg"></div><div id="publisher-custom-colours-title"></div><div id="publisher-custom-colours-header"></div><div id="publisher-custom-colours-iconcls"></div></div>',rgbInput:'<div class="rgbInput"><label for="red">R</label><input type="text" name="red" maxlength="3" /><label for="green">G</label><input type="text" name="green" maxlength="3" /><label for="blue">B</label><input type="text" name="blue" maxlength="3" /></div>',iconClsInput:'<div class="iconClsInput"><input type="radio" name="custom-icon-class" value="icon-close" /><label for="icon-close"></label><input type="radio" name="custom-icon-class" value="icon-close-white" /><label for="icon-close-white"></label></div>'},init:function(e){var t=this,n=e||{},r,i,s;this.values={colourScheme:n.colourScheme,font:n.font,toolStyle:n.toolStyle};for(r in this.fields)this.fields.hasOwnProperty(r)&&(i=this.fields[r],s=i.getContent.apply(t,arguments),i.content=s);e!==null&&e!==undefined&&(this._sendFontChangedEvent(this.values.font),this._sendColourSchemeChangedEvent(this.values.colourScheme),this._sendToolStyleChangedEvent(this._getItemByCode(this.values.toolStyle,this.initialValues.toolStyles)))},stop:function(){this._closePopups()},getPanel:function(){var e=Oskari.clazz.create("Oskari.userinterface.component.AccordionPanel"),t=e.getContainer(),n,r,i;e.setTitle(this.loc.layout.label);for(n in this.fields)this.fields.hasOwnProperty(n)&&(r=this.fields[n],t.append(r.content));return e},getValues:function(){var e=jQuery("input[name=publisher-colour]").attr("data-colour-code");this.values.colourScheme=this._getItemByCode(e,this.initialValues.colours),this.values.font=jQuery("select[name=publisher-fonts]").val();var t=jQuery("select[name=publisher-toolStyles]").val();return this.values.toolStyle=this._getItemByCode(t,this.initialValues.toolStyles),this.values},_closePopups:function(){this._colourSchemePopup&&this._colourSchemePopup.close(!0),this._customColoursPopup&&this._customColoursPopup.close(!0),this._colourSchemePopup=null,this._customColoursPopup=null},_getColoursTemplate:function(){var e=this,t=this.template.colours.clone(),n=this.values.colourScheme||{},r=this.loc.layout.fields.colours[n.val],i=this.loc.layout.fields.colours.label,s=this.loc.layout.fields.colours.placeholder,o=this.loc.layout.fields.colours.buttonLabel;return t.find("label").html(i),t.find("button").html(o).on("click",function(t){e._openColourDialog(jQuery(this))}),t.find("input[name=publisher-colour]").attr("placeholder",s).val(r),t},_getFontsTemplate:function(){var e=this,t=this.template.fonts.clone(),n=this.loc.layout.fields.fonts.label,r=this.initialValues.fonts,i=r.length,s,o,u;t.find("label").html(n).after("<br />");for(o=0;o<i;++o)s=this.template.option.clone(),s.attr({value:r[o].val}).html(r[o].name),t.find("select").append(s);return t.find("select").on("change",function(t){u=jQuery(this).val(),e._sendFontChangedEvent(u)}),jQuery(t.find("select option")).filter(function(){return jQuery(this).val()===e.values.font}).prop("selected","selected"),t},_getToolStylesTemplate:function(){var e=this,t=this.template.toolStyles.clone(),n=this.loc.layout.fields.toolStyles.label,r=this.initialValues.toolStyles,i=r.length,s,o,u,a,f;t.find("label").html(n).after("<br />");for(u=0;u<i;++u)s=this.template.option.clone(),o=this.loc.layout.fields.toolStyles[r[u].val],s.attr({value:r[u].val}).html(o),t.find("select").append(s);return t.find("select").on("change",function(t){a=jQuery(this).val(),f=e._getItemByCode(a,e.initialValues.toolStyles),e._sendToolStyleChangedEvent(f)}),jQuery(t.find("select option")).filter(function(){return e.values.toolStyle&&jQuery(this).val()===e.values.toolStyle}).prop("selected","selected"),t},_openColourDialog:function(e){var t=this,n=Oskari.clazz.create("Oskari.userinterface.component.Popup"),r=Oskari.clazz.create("Oskari.userinterface.component.Button"),i=this.loc.layout.popup.title,s=this.template.coloursPopup.clone(),o=this.initialValues.colours,u=o.length,a,f,l,c,h,p;r.setTitle(this.loc.layout.popup.close),r.setHandler(function(){n.close(!0),t._colourSchemePopup=null}),s.find("div#publisher-colour-preview").append(t._createGfiPreview());for(l=0;l<u;++l){a=this.template.inputRadio.clone(),f=this.loc.layout.fields.colours[o[l].val],a.find("input[type=radio]").attr({id:o[l].val,name:"colour",value:o[l].val}),a.find("label").html(f).attr({"for":o[l].val}),c=t.values.colourScheme;if(c&&c.val===o[l].val||!c&&o[l].val==="dark_grey")a.find("input[type=radio]").attr("checked","checked"),t._changeGfiColours(o[l],s);s.find("div#publisher-colour-inputs").append(a),"custom"===o[l].val&&(p=jQuery("<button>"+this.loc.layout.fields.colours.buttonLabel+"</button>"),p.click(function(){a.find("input[type=radio]").attr("checked","checked"),t._createCustomColoursPopup()}),s.find("div#publisher-colour-inputs").append(p))}s.find("input[name=colour]").change(function(e){h=t._getItemByCode(jQuery(this).val(),t.initialValues.colours),t._changeGfiColours(h,s),f=t.loc.layout.fields.colours[h.val],jQuery("div.basic_publisher").find("input[name=publisher-colour]").val(f).attr("data-colour-code",h.val),t._sendColourSchemeChangedEvent(h)}),n.show(i,s,[r]),this._colourSchemePopup=n},_createCustomColoursPopup:function(){var e=this,t=Oskari.clazz.create("Oskari.userinterface.component.Popup"),n=Oskari.clazz.create("Oskari.userinterface.component.Button"),r=this.loc.layout.fields.colours.custom,i=this._createCustomColoursInputs(),s=jQuery("div#publisher-colour-inputs input#custom").attr("checked"),o;n.setTitle(this.loc.layout.popup.close),n.setHandler(function(){e._collectCustomColourValues(i),s&&(o=e._getItemByCode("custom",e.initialValues.colours),e._changeGfiColours(o),e._sendColourSchemeChangedEvent(o)),t.close(!0),e._customColoursPopup=null}),t.show(r,i,[n]),this._customColoursPopup=t},_createCustomColoursInputs:function(){var e=this,t=this.template.customClrs.clone(),n=this.template.rgbInput.clone(),r=this.loc.layout.fields.colours.customLabels.bgLabel,i=this.template.rgbInput.clone(),s=this.loc.layout.fields.colours.customLabels.titleLabel,o=this.template.rgbInput.clone(),u=this.loc.layout.fields.colours.customLabels.headerLabel,a=this.template.iconClsInput.clone(),f=this.loc.layout.fields.colours.customLabels.iconLabel,l=this.loc.layout.fields.colours.customLabels.iconCloseLabel,c=this.loc.layout.fields.colours.customLabels.iconCloseWhiteLabel,h;return a.find("label[for=icon-close]").html(l),a.find("label[for=icon-close-white]").html(c),t.find("div#publisher-custom-colours-bg").append(r).append(n),t.find("div#publisher-custom-colours-title").append(s).append(i),t.find("div#publisher-custom-colours-header").append(u).append(o),t.find("div#publisher-custom-colours-iconcls").append(f).append(a),this._prepopulateCustomColoursTemplate(t),t.find("input[type=text]").change(function(){h=jQuery(this).val(),isNaN(h)||h<e.minColourValue?jQuery(this).val(e.minColourValue):h>e.maxColourValue&&jQuery(this).val(e.maxColourValue)}),t},_prepopulateCustomColoursTemplate:function(e){var t=e.find("div#publisher-custom-colours-bg"),n=e.find("div#publisher-custom-colours-title"),r=e.find("div#publisher-custom-colours-header"),i=e.find("div#publisher-custom-colours-iconcls"),s=this.customColourValues;this._prepopulateRgbDiv(t,s.bg),this._prepopulateRgbDiv(n,s.title),this._prepopulateRgbDiv(r,s.header),i.find("input[type=radio]").removeAttr("checked"),i.find("input[value="+s.iconCls+"]").attr("checked","checked")},_collectCustomColourValues:function(e){var t=this._getColourFromRgbDiv(e.find("div#publisher-custom-colours-bg")),n=this._getColourFromRgbDiv(e.find("div#publisher-custom-colours-title")),r=this._getColourFromRgbDiv(e.find("div#publisher-custom-colours-header")),i=e.find("div#publisher-custom-colours-iconcls input[name=custom-icon-class]:checked").val(),s=this._getItemByCode("custom",this.initialValues.colours);this.customColourValues.bg=t,this.customColourValues.title=n,this.customColourValues.header=r,this.customColourValues.iconCls=i,s.bgColour=this._getCssRgb(t),s.titleColour=this._getCssRgb(n),s.headerColour=this._getCssRgb(r),s.iconCls=i},_prepopulateRgbDiv:function(e,t){if(!t)return;e.find("input[name=red]").val(t.red),e.find("input[name=green]").val(t.green),e.find("input[name=blue]").val(t.blue)},_getColourFromRgbDiv:function(e){var t=e.find("input[name=red]").val(),n=e.find("input[name=green]").val(),r=e.find("input[name=blue]").val();return{red:t,green:n,blue:r}},_getCssRgb:function(e){return"rgb("+e.red+", "+e.green+", "+e.blue+")"},_createGfiPreview:function(){var e=this.loc.layout.popup.gfiDialog.title,t=this.loc.layout.popup.gfiDialog.featureName,n=this.loc.layout.popup.gfiDialog.featureDesc,r=this._publisher.urlBase+Oskari.getLang(),i=jQuery("<div></div>"),s=jQuery('<div class="popupTitle"></div>'),o=jQuery('<div class="popupHeader"></div>'),u=jQuery('<div class="olPopupCloseBox icon-close-white" style="position: absolute; top: 12px;"></div>'),a=jQuery('<div class="popupContent"></div>'),f=jQuery('<div class="contentWrapper"></div>'),l=jQuery('<span class="infoboxActionLinks"><a href="#"></a></span>'),c=jQuery('<span class="infoboxActionLinks"><input type="button" /></span>'),h=jQuery('<div class="infoboxLine">separator</div>'),p=jQuery('<div class="myplaces_wrapper"><div class="myplaces_place"><h3 class="myplaces_header"></h3><p class="myplaces_desc"></p><img class="myplaces_img"></img><a class="myplaces_link"></a></div></div>');return s.append(e),o.append(s),o.append(u),o.css({width:"320px"}),p.find("h3.myplaces_header").html(t),p.find("p.myplaces_desc").html(n),p.find("a.myplaces_link").html(r).attr("href",r),a.append(p),a.css({"margin-left":"0px",height:"120px"}),f.append(a),f.css({width:"320px"}),i.append(o).append(f),i},_changeGfiColours:function(e,t){t=t||jQuery("div#publisher-colour-popup");var n=t.find("div.popupHeader"),r=t.find("div.popupTitle"),i=t.find("h3.myplaces_header"),s=t.find("div.olPopupCloseBox");n.css({"background-color":e.bgColour}),r.css({color:e.titleColour}),i.css({color:e.headerColour}),s.removeClass("icon-close-white"),s.removeClass("icon-close"),s.addClass(e.iconCls)},_sendColourSchemeChangedEvent:function(e){this._sendEvent("Publisher.ColourSchemeChangedEvent",e)},_sendFontChangedEvent:function(e){this._sendEvent("Publisher.FontChangedEvent",e)},_sendToolStyleChangedEvent:function(e){this._sendEvent("Publisher.ToolStyleChangedEvent",e)},_sendEvent:function(e,t){var n=this._sandbox.getEventBuilder(e),r;n&&(r=n(t),this._sandbox.notifyAll(r))},_getItemByCode:function(e,t){var n=t.length,r;for(r=0;r<n;++r)if(t[r].val===e)return t[r];return null}}),define("bundles/framework/bundle/publisher/view/PublisherLayoutForm",function(){}),define("normalize",["require","module"],function(e,t){function o(e,t,n){if(e.indexOf("data:")===0)return e;e=r(e);if(e.match(/^\//)||e.match(s))return e;var i=n.match(s),o=t.match(s);return o&&(!i||i[1]!=o[1]||i[2]!=o[2])?u(e,t):a(u(e,t),n)}function u(e,t){e.substr(0,2)=="./"&&(e=e.substr(2));var n=t.split("/"),r=e.split("/");n.pop();while(curPart=r.shift())curPart==".."?n.pop():n.push(curPart);return n.join("/")}function a(e,t){var n=t.split("/");n.pop(),t=n.join("/")+"/",i=0;while(t.substr(i,1)==e.substr(i,1))i++;while(t.substr(i,1)!="/")i--;t=t.substr(i+1),e=e.substr(i+1),n=t.split("/");var r=e.split("/");out="";while(n.shift())out+="../";while(curPart=r.shift())out+=curPart+"/";return out.substr(0,out.length-1)}var n=/([^:])\/+/g,r=function(e){return e.replace(n,"$1/")},s=/[^\:\/]*:\/\/([^\/])*/,f=function(e,t,n,i){t=r(t),n=r(n);var s=/@import\s*("([^"]*)"|'([^']*)')|url\s*\(\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/ig,u,a,e;while(u=s.exec(e)){a=u[3]||u[2]||u[5]||u[6]||u[4];var f;i&&a.substr(0,1)=="/"?f=i+a:f=o(a,t,n);var l=u[5]||u[6]?1:0;e=e.substr(0,s.lastIndex-a.length-l-1)+f+e.substr(s.lastIndex-l-1),s.lastIndex=s.lastIndex+(f.length-a.length)}return e};return f.convertURIBase=o,f}),define("css",["./normalize"],function(e){function n(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}var t=0;if(typeof window=="undefined")return{load:function(e,t,n){n()}};var r=!1,i=document.getElementsByTagName("head")[0],s=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)/),o=!1;!s||(s[1]||s[7]?(o=parseInt(s[1])<6||parseInt(s[7])<=9,s="trident"):s[2]?(o=!0,s="webkit"):s[3]||(s[4]?(o=parseInt(s[4])<18,s="gecko"):r&&alert("Engine detection failed")));var u={},a=/^\/|([^\:\/]*:)/;u.pluginBuilder="./css-builder";var f=[],l={},c=[];u.addBuffer=function(e){if(n(f,e)!=-1)return;if(n(c,e)!=-1)return;f.push(e),c.push(e)},u.setBuffer=function(t,n){var r=window.location.pathname.split("/");r.pop(),r=r.join("/")+"/";var i=require.toUrl("base_url").split("/");i.pop();var s=i.join("/")+"/";s=e.convertURIBase(s,r,"/"),s.match(a)||(s="/"+s),s.substr(s.length-1,1)!="/"&&(s+="/"),u.inject(e(t,s,r));for(var o=0;o<f.length;o++)(n&&f[o].substr(f[o].length-5,5)==".less"||!n&&f[o].substr(f[o].length-4,4)==".css")&&(function(e){l[e]=l[e]||!0,setTimeout(function(){typeof l[e]=="function"&&l[e](),delete l[e]},7)}(f[o]),f.splice(o--,1))},u.attachBuffer=function(e,t){for(var r=0;r<f.length;r++)if(f[r]==e)return l[e]=t,!0;if(l[e]===!0)return l[e]=t,!0;if(n(c,e)!=-1)return t(),!0};var h=function(e,t){setTimeout(function(){for(var n=0;n<document.styleSheets.length;n++){var r=document.styleSheets[n];if(r.href==e.href)return t()}h(e,t)},10)},p=function(e,t){setTimeout(function(){try{return e.sheet.cssRules,t()}catch(n){}p(e,t)},10)};if(s=="trident"&&o)var d=[],v=[],m=0,g=function(e,t){var n;v.push({url:e,cb:t}),n=d.shift(),!n&&m++<31&&(n=document.createElement("style"),i.appendChild(n)),n&&y(n)},y=function(e){var t=v.shift();if(!t){e.onload=w,d.push(e);return}e.onload=function(){t.cb(t.ss),y(e)};try{var n=e.styleSheet;t.ss=n.imports[n.addImport(t.url)]}catch(r){alert("Got Error:"+r)}};var b=function(e){var t=document.createElement("link");return t.type="text/css",t.rel="stylesheet",t.href=e,t},w=function(){};u.linkLoad=function(e,t){var n=setTimeout(function(){r&&alert("timeout"),t()},A*1e3-100),u=function(){clearTimeout(n),a&&(a.onload=w),setTimeout(t,7)};if(!o){var a=b(e);a.onload=u,i.appendChild(a)}else if(s=="webkit"){var a=b(e);h(a,u),i.appendChild(a)}else if(s=="gecko"){var f=document.createElement("style");f.textContent='@import "'+e+'"',p(f,u),i.appendChild(f)}else s=="trident"&&g(e,u)};var E=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],S={},x=function(e,t,n){if(S[e]){t(S[e]);return}var r,i,s;if(typeof XMLHttpRequest!="undefined")r=new XMLHttpRequest;else if(typeof ActiveXObject!="undefined")for(i=0;i<3;i+=1){s=E[i];try{r=new ActiveXObject(s)}catch(o){}if(r){E=[s];break}}r.open("GET",e,requirejs.inlineRequire?!1:!0),r.onreadystatechange=function(i){var s,o;r.readyState===4&&(s=r.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=r,n(o)):(S[e]=r.responseText,t(r.responseText)))},r.send(null)},T=0,N;u.inject=function(e){T<31&&(N=document.createElement("style"),N.type="text/css",i.appendChild(N),T++),N.styleSheet?N.styleSheet.cssText+=e:N.appendChild(document.createTextNode(e))};var C=/@import\s*(url)?\s*(('([^']*)'|"([^"]*)")|\(('([^']*)'|"([^"]*)"|([^\)]*))\))\s*;?/g,k=window.location.pathname.split("/");k.pop(),k=k.join("/")+"/";var L=function(t,n,r){t.match(a)||(t="/"+e.convertURIBase(t,k,"/")),x(t,function(i){i=e(i,t,k);var s=[],o=[],u=[],a;while(a=C.exec(i)){var f=a[4]||a[5]||a[7]||a[8]||a[9];s.push(f),o.push(C.lastIndex-a[0].length),u.push(a[0].length)}var l=0;for(var c=0;c<s.length;c++)(function(e){L(s[e],function(t){i=i.substr(0,o[e])+t+i.substr(o[e]+u[e]);var r=t.length-u[e];for(var a=e+1;a<s.length;a++)o[a]+=r;l++,l==s.length&&n(i)},r)})(c);s.length==0&&n(i)},r)};u.normalize=function(e,t){return e.substr(e.length-4,4)==".css"&&(e=e.substr(0,e.length-4)),t(e)};var A,O=!1;return u.load=function(e,t,n,i,s){A=A||i.waitSeconds||7;var a=e+(s?".less":".css");if(u.attachBuffer(a,n))return;var f=t.toUrl(a);!O&&r&&(alert(o?"hacking links":"not hacking"),O=!0),s?L(f,function(e){s&&(e=s(e,function(e){u.inject(e),setTimeout(n,7)}))}):u.linkLoad(f,n)},r&&(u.inspect=function(){if(stylesheet.styleSheet)return stylesheet.styleSheet.cssText;if(stylesheet.innerHTML)return stylesheet.innerHTML}),u}),requirejs.s.contexts._.nextTick=function(e){e()},require(["css"],function(e){e.addBuffer("resources/framework/bundle/publisher/css/style.css")}),requirejs.s.contexts._.nextTick=requirejs.nextTick,Oskari.clazz.define("Oskari.mapframework.bundle.publisher.request.PublishMapEditorRequest",function(e){this._viewData=e},{__name:"Publisher.PublishMapEditorRequest",getName:function(){return this.__name},getEditMap:function(){return this._viewData}},{protocol:["Oskari.mapframework.request.Request"]}),define("bundles/framework/bundle/publisher/request/PublishMapEditorRequest",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.publisher.request.PublishMapEditorRequestHandler",function(e){this.instance=e},{handleRequest:function(e,t){this.instance.publishId=t.getEditMap().id,this.instance.setPublishMode(!0,this.instance.getLayersWithoutPublishRights(),t.getEditMap()),this._showEditNotification()},_showEditNotification:function(){var e=this.instance.getLocalization("edit"),t=Oskari.clazz.create("Oskari.userinterface.component.Popup");t.show(e.popup.title,e.popup.msg),t.fadeout()}},{protocol:["Oskari.mapframework.core.RequestHandler"]}),define("bundles/framework/bundle/publisher/request/PublishMapEditorRequestHandler",function(){}),Oskari.registerLocalization({lang:"fi",key:"Publisher",value:{title:"Julkaise kartta",flyouttitle:"Siirry julkaisemaan",desc:"",published:{title:"Kartta julkaistu",desc:"Voit liitt kartan internet-sivustollesi lismll sinne alla olevan HTML-koodin:"},edit:{popup:{title:"Muokataan julkaisua",msg:"Pivitetn aiemmin julkaistun kartan tietoja"}},BasicView:{title:"Julkaise kartta",titleEdit:"Muokkaa julkaisua",domain:{title:"Julkaisupaikka",label:"Sivusto, jolla kartta julkaistaan",placeholder:"ilman http- tai www-etuliitteit",tooltip:"Kirjoita sivuston www-osoite eli domain-nimi ilman http- ja www-etuliitteit tai alasivun osoitetta. Esimerkiksi omakotisivu.com."},name:{label:"Kartan nimi",placeholder:"pakollinen",tooltip:"Anna kartalle kuvaileva nimi. Huomioi kyttliittymn kieli."},language:{label:"Kieli",options:{fi:"Suomi",sv:"Ruotsi",en:"Englanti"},tooltip:"Valitse kartan kyttliittymn ja aineiston kieli."},size:{label:"Koko",tooltip:"Valitse tai mrittele kartalle koko, jossa haluat esitt sen sivuillasi. Net vaikutuksen esikatselukartassa."},tools:{label:"Nytettvt tykalut",tooltip:"Valitse kartalla nytettvt tykalut. Net niiden sijoittelun esikatselukartassa.",ScaleBarPlugin:"Mittakaavajana",IndexMapPlugin:"Indeksikartta",PanButtons:"Panorointitoiminto",Portti2Zoombar:"Mittakaavasdin",ControlsPlugin:"Kartan liikuttaminen",SearchPlugin:"Osoite- ja paikannimihaku",GetInfoPlugin:"Kohdetietojen kyselytykalu",PublisherToolbarPlugin:"Karttatykalut"},toolbarToolNames:{history_back:"Siirry taaksepin",history_forward:"Siirry eteenpin",measureline:"Mittaa etisyytt",measurearea:"Mittaa aluetta"},toollayout:{label:"Tykalujen asettelu",tooltip:"Valitse kartalla nytettvien tykalujen asettelu",lefthanded:"Vasenktinen",righthanded:"Oikeaktinen"},data:{label:"Tilastot",tooltip:"Nyt karttaan liittyv taulukko.",grid:"Nyt tilastotaulukko"},layout:{label:"Ulkoasu",fields:{colours:{label:"Vrimaailma",placeholder:"Valitse vrimaailma",buttonLabel:"Vaihda",light_grey:"Vaalean harmaa",dark_grey:"Tumman harmaa",blue:"Sininen",red:"Punainen",green:"Vihre",yellow:"Keltainen",custom:"Omat vrit",customLabels:{bgLabel:"Tunnisteen tausta",titleLabel:"Tunnisteen teksti",headerLabel:"Otsikon teksti",iconLabel:"Ikoni",iconCloseLabel:"Tumma",iconCloseWhiteLabel:"Vaalea"}},fonts:{label:"Valitse fontti"},toolStyles:{label:"Tykalujen tyyli","rounded-dark":"Pyristetty (tumma)","rounded-light":"Pyristetty (vaalea)","sharp-dark":"Kulmikas (tumma)","sharp-light":"Kulmikas (vaalea)","3d-dark":"3D (tumma)","3d-light":"3D (vaalea)"}},popup:{title:"Vrimaailman valinta",close:"Sulje",gfiDialog:{title:"Kohteen tiedot",featureName:"Esikatselu",featureDesc:"Vrimaailman valinta vaikuttaa ainoastaan kohdetietolaatikon ja karttatasovalikon vritykseen"}}},layers:{label:"Karttatasot",defaultLayer:"(Oletusvalinta)",useAsDefaultLayer:"Kyt oletuksena"},sizes:{small:"Pieni",medium:"Keskikokoinen",large:"Suuri",custom:"Mrit oma koko",width:"leveys",height:"korkeus"},buttons:{save:"Tallenna",saveNew:"Tallenna uusi",ok:"OK",replace:"Korvaa",cancel:"Peruuta",add:"Lis karttataso"},confirm:{replace:{title:"Haluatko korvata julkaisun?",msg:"Korvaamalla muutokset nkyvt suoraan julkaisemassasi kartassa. Sinun ei tarvitse list koodia verkkosivuillesi uudelleen."}},layerselection:{label:"Nyt karttatasot valikossa",info:"Valitse karttapohjat. Voit tehd oletusvalinnan esikatselunkymst.",tooltip:"Karttapohja nkyy kartan alimmaisena kerroksena. Kun valitset karttatasoja karttapohjaksi, vain yksi valituista tasoista nkyy kerralla ja kyttj voi vaihdella niiden vlill. Oletusvalinnan voit tehd esikatselukartassa.",promote:"Haluatko nytt mys ilmakuvia?"},preview:"Julkaistavan kartan esikatselu",location:"Sijainti ja mittakaavataso",zoomlevel:"Mittakaavataso",help:"Ohje",error:{title:"Virhe!",size:"Virhe kokomrityksiss",domain:"Sivusto on pakollinen tieto",domainStart:"Anna sivusto ilman http- tai www-etuliitteit",name:"Nimi on pakollinen tieto",nohelp:"Ohjetta ei lytynyt",saveFailed:"Kartan julkaisu eponnistui. Yrit myhemmin uudelleen.",nameIllegalCharacters:"Nimess on luvattomia merkkej. Sallittuja merkkej ovat kaikki suomen kielen aakkoset, numerot sek vlilynti ja yhdysmerkki.",domainIllegalCharacters:"Sivuston nimess on luvattomia merkkej. Sallittuja merkkej ovat kaikki suomen kielen aakkoset, numerot sek vlilynti ja yhdysmerkki."}},NotLoggedView:{text:"Voit kytt julkaisutoimintoa kirjauduttuasi palveluun.",signup:"Kirjaudu sisn",signupUrl:"/web/fi/login",register:"Rekisteridy",registerUrl:"/web/fi/login?p_p_id=58&p_p_lifecycle=1&p_p_state=maximized&p_p_mode=view&p_p_col_id=column-1&p_p_col_count=1&saveLastPath=0&_58_struts_action=%2Flogin%2Fcreate_account"},StartView:{text:"Voit julkaista tss tekemsi karttankymn osana esim. omaa tai yrityksesi sivustoa.",touLink:"Nyt karttajulkaisun kyttehdot",layerlist_title:"Julkaistavissa olevat karttatasot",layerlist_empty:"Valitsemiasi karttatasoja ei voida julkaista. Valitut karttatasot -valikosta net, voiko karttatason julkaista.",layerlist_denied:"Ei julkaistavissa",denied_tooltip:"Kartta-aineistojen tuottajat eivt ole antaneet nille aineistoilleen julkaisuoikeutta muissa verkkopalveluissa. Tarkista julkaisuoikeus Valitut karttatasot -valikosta ennen julkaisua.",myPlacesDisclaimer:"Huom. Olet julkaisemassa omaa karttatasoa.",buttons:{"continue":"Jatka",continueAndAccept:"Hyvksy ehdot ja jatka",cancel:"Peruuta",close:"Sulje"},tou:{notfound:"Kyttehtoja ei lytynyt",reject:"Hylk",accept:"Hyvksy"}},layer:{show:"Nyt",hide:"Piilota",hidden:"Karttataso on tilapisesti piilotettu.",selectAsBaselayer:"Valitse pohjakartaksi",rights:{can_be_published_map_user:{label:"Julkaistavissa",tooltip:"Karttatason voi julkaista upotetussa karttaikkunassa. Viikoittainen kyttmr voi olla rajoitettu."}}}}}),define("bundles/framework/bundle/publisher/locale/fi",function(){}),Oskari.registerLocalization({lang:"sv",key:"Publisher",value:{title:"Definiera karta",flyouttitle:"Definiera karta",desc:"",published:{title:"Kartan har avskilts",desc:"Inbdda kartan genom att tillgga HTML-koden nedan p din webbplats."},edit:{popup:{title:"Den inbddade kartan editeras",msg:"Den tidigare inbddade kartans uppgifter uppdateras"}},BasicView:{title:"Inbdda kartan",titleEdit:"Editera inbddad karta",domain:{title:"Webbsidan dr kartan inbddas",label:"Webbplatsen dr kartan inbddas",placeholder:"utan http- eller www-prefix",tooltip:"Skriv namnet p webbplatsens hemsida dvs. domainnamn utan prefixerna http och www samt utan undersida. Exempel: minhemsida.com"},name:{label:"Kartans namn",placeholder:"obligatorisk uppgift",tooltip:"Ge kartan ett beskrivande namn. Observera anvndargrnssnittets sprk"},language:{label:"Sprk",options:{fi:"Finska",sv:"Svenska",en:"Engelska"},tooltip:"Vlj sprk fr kartmaterial och anvndargrnssnitt."},size:{label:"Storlek",tooltip:"Vlj eller definiera storleken p kartan som visas p din webbplats. Kartan frhandsvisas i den valda storleken."},tools:{label:"Verktyg",tooltip:"Vlj verktygen som visas p kartan. Du kan se deras placering p den frhandsvisade kartan.",ScaleBarPlugin:"Skalstrcka",IndexMapPlugin:"Indexkarta",PanButtons:"Panoreringsverktyg",Portti2Zoombar:"Skalans glidreglage",ControlsPlugin:"Panorering p",SearchPlugin:"Adress- och ortnamnsskning",GetInfoPlugin:"Verktyg fr frfrgan som gller uppgifter om objektet",PublisherToolbarPlugin:"Kartverktygen"},toolbarToolNames:{history_back:"G bakt",history_forward:"G framt",measureline:"Mta avstnd",measurearea:"Mta omrde"},toollayout:{label:"Verktyg applikation",tooltip:"Vlj en applikation fr de verktyg som visas p kartan",lefthanded:"Vnsterhnt",righthanded:"Hgerhnt"},data:{label:"Statistik",tooltip:"Show the data related to map.",grid:"Visa statistik bord"},layout:{label:"Layout",fields:{colours:{label:"Frgschema",placeholder:"Vlj frgschema",buttonLabel:"Byt",light_grey:"Ljusgr",dark_grey:"Mrkgr",blue:"Bl",red:"Rd",green:"Grn",yellow:"Gul",custom:"Egna frger",customLabels:{bgLabel:"Etikettens bakgrundsfrg",titleLabel:"Etikettext",headerLabel:"Rubriktext",iconLabel:"Ikon",iconCloseLabel:"Mrk",iconCloseWhiteLabel:"Ljus"}},fonts:{label:"Vlj typsnitt"},toolStyles:{label:"Verktygens stil","rounded-dark":"Avrundad (mrk)","rounded-light":"Avrundad (ljus)","sharp-dark":"Kantig (mrk)","sharp-light":"Kantig (ljus)","3d-dark":"3D (mrk)","3d-light":"3D (ljus)"}},popup:{title:"Vlj frgschema",close:"Stng",gfiDialog:{title:"Frhandsgranskning",featureName:"Frhandsgranskning",featureDesc:"Valet av frgschema pverkar endast frgen p faktarutan fr kartobjekt"}}},layers:{label:"Kartlager",defaultLayer:"(Frvald kartlager)",useAsDefaultLayer:"Anvnd som frvald kartlager"},sizes:{small:"Liten",medium:"Medelstor",large:"Stor",custom:"Definiera storlek",width:"bredd",height:"hjd"},buttons:{save:"Lagra",saveNew:"Lagra ny",ok:"OK",replace:"Erstt",cancel:"Avbryt",add:"lgg kartan lager"},confirm:{replace:{title:"Vill du erstta den inbddade kartan?",msg:"Om du erstter kartan syns ndringarna p den inbddade kartan genast. Du behver inte lgga in koden p din webbsida p nytt."}},layerselection:{label:"Visa kartlagren i menyn",info:"Vlj bakgrundskartor. Du kan gra frval i frhandsgranskningsvyn.",tooltip:"Bakgrundskartan syns som kartans nedersta lager. Nr du vljer kartan som anvnds som bakgrundskarta syns endast ett lager i taget och du kan vxla mellan dem. Du kan gra frval i frhandsgranskningsvyn.",promote:"Visa flygbilder?"},preview:"Frhandsgranskningsvy fr karta som ska avskiljas och inbddas.",location:"Lge och skalniv.",zoomlevel:"Skalniv",help:"Anvisning",error:{title:"Fel!",size:"Fel i storleksdefinitionerna",domain:"Webbplatsen r en ndvndig uppgift",domainStart:"Skriv webbplatsen utan prefixerna http och www",name:"Namnet r en ndvndig uppgift",nohelp:"Ingen anvisning",saveFailed:"Avskiljandet av kartan misslyckades. Frsk p nytt senare.",nameIllegalCharacters:"I namnet ingr otilltna tecken. Tilltna r alla bokstver i det svenska alfabetet, siffror, mellanslag och bindestreck.",domainIllegalCharacters:"I webbsidans namnet ingr otilltna tecken. Tilltna r alla bokstver i det svenska alfabetet, siffror, mellanslag och bindestreck."}},NotLoggedView:{text:"Logga in i tjnsten fr att definiera en karta som ska inbddas.",signup:"Logga in",signupUrl:"/web/sv/login",register:"Registrera dig",registerUrl:"/web/sv/login?p_p_id=58&p_p_lifecycle=1&p_p_state=maximized&p_p_mode=view&p_p_col_id=column-1&p_p_col_count=1&saveLastPath=0&_58_struts_action=%2Flogin%2Fcreate_account"},StartView:{text:"Du kan inbdda den kartvy som du definierat hr p din egen eller din arbetsgivares webbplats.",touLink:"Vis anvndningsvillkor till kartinbddningen",layerlist_title:"Kartlager som kan inbddas",layerlist_empty:"Kartlagren som du valt kan inte avskiljas. Menyn Valda kartlager visar vilka kartlager kan avskiljas.",layerlist_denied:"Kan inte avskiljas",denied_tooltip:"Kartdataproducenterna har inte gett publiceringstillstnd till dessa material i andra webbtjnster. Kontrollera publiceringstillstndet i menyn Valda kartlager innan du avskiljer dem.",myPlacesDisclaimer:"Obs! du ska publicera din egen kartlagret.",buttons:{"continue":"Fortstt",continueAndAccept:"Godknn anvndningsvillkor och fortstt",cancel:"Tillbaka",close:"Avbryt"},tou:{notfound:"Anvndningsvillkor kan inte hittas",reject:"Avvisa",accept:"Acceptera"}},layer:{show:"Visa",hide:"Gm",hidden:"Kartan r tillflligt gmd.",rights:{can_be_published_map_user:{label:"Fr publiceras",tooltip:"Kartlagret fr publiceras i ett inbddat kartfnster. Antalet anvndare per vecka kan vara begrnsat."}}}}}),define("bundles/framework/bundle/publisher/locale/sv",function(){}),Oskari.registerLocalization({lang:"en",key:"Publisher",value:{title:"Create map",flyouttitle:"Create map",desc:"",published:{title:"Your map has been created",desc:"Embed the map by adding the HTML code below to your website."},edit:{popup:{title:"Editing embedded map",msg:"The map data of a previously embedded map is being updated"}},BasicView:{title:"Embed map",titleEdit:"Edit embedded map",domain:{title:"Webpage where the map will be embedded",label:"Website where the map will be embedded",placeholder:"without the prefixes http or www",tooltip:"Write the name of your website's index page, e.g. its domain name without the prefixes http or www, or the address of a subpage. Example: myhomepage.com"},name:{label:"The name of the map",placeholder:"required",tooltip:"Give your map a descriptive name. Please note the language of the user interface."},language:{label:"Language",options:{fi:"Finnish",sv:"Swedish",en:"English"},tooltip:"Select the language of the map interface and map data."},size:{label:"Size",tooltip:"Select or define the size of the map to be embedded on your website. The map preview is displayed in the selected size."},tools:{label:"Tools",tooltip:"Select the tools to be shown on the map. Their placement is displayed in the map preview.",ScaleBarPlugin:"Scale line",IndexMapPlugin:"Index map",PanButtons:"Panning tool",Portti2Zoombar:"Scale scrollbar",ControlsPlugin:"Panning on",SearchPlugin:"Address and place name search",GetInfoPlugin:"Query tool for place data",PublisherToolbarPlugin:"map tools"},toolbarToolNames:{history_back:"Move backward",history_forward:"Move forward",measureline:"Measure distance",measurearea:"Measure area"},toollayout:{label:"Tool layout",tooltip:"Choose a layout for the tools shown on the map",lefthanded:"Lefthanded",righthanded:"Righthanded"},data:{label:"Statistics",tooltip:"Show the data related to map.",grid:"Show statistic grid"},layout:{label:"Layout",fields:{colours:{label:"Colour scheme",placeholder:"Select colour scheme",buttonLabel:"Change",light_grey:"Light grey",dark_grey:"Dark grey",blue:"Blue",red:"Red",green:"Green",yellow:"Yellow",custom:"Custom colours",customLabels:{bgLabel:"Identifier background",titleLabel:"Identifier text",headerLabel:"Header text",iconLabel:"Icon",iconCloseLabel:"Dark",iconCloseWhiteLabel:"Light"}},fonts:{label:"Select font"},toolStyles:{label:"Tool style","rounded-dark":"Rounded (dark)","rounded-light":"Rounded (light)","sharp-dark":"Polygon (dark)","sharp-light":"Polygon (light)","3d-dark":"3D (dark)","3d-light":"3D (light)"}},popup:{title:"Select colour scheme",close:"Close",gfiDialog:{title:"Preview",featureName:"Preview",featureDesc:"The selected colour scheme only affects the colours of the feature info and layer selection popups"}}},layers:{label:"Map layers",defaultLayer:"(Default layer)",useAsDefaultLayer:"Use as default layer"},sizes:{small:"Small",medium:"Medium",large:"Large",custom:"Custom size",width:"width",height:"height"},buttons:{save:"Save",saveNew:"Save new",ok:"OK",replace:"Replace",cancel:"Cancel",add:"add map layer"},confirm:{replace:{title:"Do you wish to replace the embedded map?",msg:"Use replace to show changes on the embedded map without delay. It is not necessary to add the html-code to your webpage again."}},layerselection:{label:"Show map layers in menu",info:"Select background maps. You can set the default background map in the map preview window.",tooltip:"The background map is shown as the bottom layer of the map. When you select map layers to be used as the bottom layer, only one layer is visible at a time and you can switch between them. You can set the default background map in the map preview.",promote:"Show aerial images?"},preview:"Preview of the map to be embedded.",location:"Location and zoom level",zoomlevel:"Zoom level",help:"Help",error:{title:"Error!",size:"Error in size definitions",domain:"Website is required information",domainStart:"Omit prefixes http or www from the website name",name:"Name is required information",nohelp:"No help is available",saveFailed:"Map publishing failed. Try again later.",nameIllegalCharacters:"The name contains disallowed characters. Allowed characters are the letters a-z as well as ,  and , numbers, backspaces and hyphens.",domainIllegalCharacters:"The web site name contains disallowed characters. Allowed characters are the letters a-z as well as ,  and , numbers, backspaces and hyphens."}},NotLoggedView:{text:"You need to log in before using the embedding function.",signup:"Log in",signupUrl:"/web/en/login",register:"Register",registerUrl:"/web/en/login?p_p_id=58&p_p_lifecycle=1&p_p_state=maximized&p_p_mode=view&p_p_col_id=column-1&p_p_col_count=1&saveLastPath=0&_58_struts_action=%2Flogin%2Fcreate_account"},StartView:{text:"You can embed the map view you just created on your own or your employer's website.",touLink:"Show Terms of use for Embedded maps",layerlist_title:"Embeddable map layers",layerlist_empty:"The map layers you selected cannot be embedded. The menu Selected map layers shows whether or not a map layer can be embedded.",layerlist_denied:"Cannot be embedded",denied_tooltip:"The providers of this map data have not granted permission to publish these materials on other websites. Check rights to publish in the menu Selected map layers before embedding.",myPlacesDisclaimer:"NB. you are going to publish your own map layer.",buttons:{"continue":"Continue",continueAndAccept:"Accept Terms of use and continue",cancel:"Cancel",close:"Close"},tou:{notfound:"Can not find Terms of Use",reject:"Reject",accept:"Accept"}},layer:{show:"Show",hide:"Hide",hidden:"The map has been temporarily hidden.",rights:{can_be_published_map_user:{label:"Publication permitted",tooltip:"The map layer can be published in an embedded map window and the number of users per week may be limited."}}}}}),define("bundles/framework/bundle/publisher/locale/en",function(){}),Oskari.registerLocalization({lang:"cs",key:"Publisher",value:{title:"Vytvoit mapu",flyouttitle:"Vytvoit mapu",desc:"",published:{title:"Vae mapa byla vytvoena",desc:"Vlote mapu do va webov strnky vloenm HTML kdu uvedenho ne."},edit:{popup:{title:"prava vloen mapy",msg:"Data vloen mapy se aktualizuj"}},BasicView:{title:"Vloit mapu",titleEdit:"Upravit vloenou mapu",domain:{title:"Webov strnka, do kter bude mapa vloena",label:"Web, do kterho bude mapa vloena",placeholder:"bez pedpon http nebo www",tooltip:"Napite jmno hlavn strnky vaeho webu, nap. jmno jeho domny bez pedpon http nebo www nebo adresu podstrnky. Nap. myhomepage.com"},name:{label:"Jmno mapy",placeholder:"required",tooltip:"Pojmenujte vstin mapu. Pamatujte na jazyk uivatele."},language:{label:"Jazyk",options:{fi:"fintina",sv:"vdtina",en:"anglitina",de:"nmina",es:"panltina",cs:"etina"},tooltip:"Vyberte jazyk prosted a dat mapy."},size:{label:"Velikost",tooltip:"Vyberte nebo definujte velikost mapy pro vloen do va webov strnky. Nhled mapy je zobrazen ve vybran velikosti."},tools:{label:"Nstroje",tooltip:"Vyberte nstroje zobrazen v map. Jejich umstn je zobrazeno v nhledu mapy.",ScaleBarPlugin:"Mtko",IndexMapPlugin:"Pehledov mapa",PanButtons:"Posun mapy",Portti2Zoombar:"Posuvn mtko",ControlsPlugin:"Panormovn",SearchPlugin:"Vyhledvn adresy a zempisnho jmna",GetInfoPlugin:"Dotazovac nstroj pro zempisn jmna"},toollayout:{label:"Tool layout",tooltip:"Choose a layout for the tools shown on the map",lefthanded:"Lefthanded",righthanded:"Righthanded",userlayout:"Move tools",usereditmode:"Switch edit mode on",usereditmodeoff:"Switch edit mode off"},data:{label:"Statistics",tooltip:"Show the data related to map.",grid:"Show statistic grid"},layers:{label:"Mapov vrstvy",defaultLayer:"(Defaultn vrstva)",useAsDefaultLayer:"Pouij jako defalutn vrstvu"},sizes:{small:"Mal",medium:"Stedn",large:"Velk",custom:"Vlastn velikost",width:"ka",height:"vka"},buttons:{save:"Uloit",saveNew:"Uloit novou",ok:"OK",replace:"Nahradit",cancel:"Storno",add:"Pidat mapovou vrstvu"},confirm:{replace:{title:"Pejete si nahradit vloenou mapu?",msg:"Pro zobrazen zmn vloen mapy bez prodlevy pouijte nahradit. Optovn pidn html kdu do vaeho webu nen nezbytn."}},layerselection:{label:"Zobraz mapov vrstvy v menu",info:"Vyberte mapy pozad. Defaultn mapu pozad mete nastavit v okn nhledu mapy.",tooltip:"Mapa pozad je zobrazena jako spodn vrstva mapy. Kdy vyberete mapov vrstvy jako spodn vrstvu, bude vdy viditeln jen jedna vrstva. Mezi mapami pozad lze pepnat. Defaultn mapu pozad mete nastavit v okn nhledu mapy.",promote:"Zobrazit leteck snmky?"},preview:"Nhled vkldan mapy.",location:"Poloha a rove piblen",zoomlevel:"rove piblen",help:"Npovda",error:{title:"Chyba!",size:"Chyba v definici velikosti",domain:"Web je povinn daj",domainStart:"Vynechte pedpony http nebo www ve jmnu webu",name:"Jmno je povinn daj",nohelp:"Npovda nen k dispozici",saveFailed:"Publikovn mapy selhalo. Zkuste to pozdji.",nameIllegalCharacters:"Jmno obsahuje nepovolen znaky. Povolen znaky jsou a-z, ,  a , sla, mezery a pomlky.",domainIllegalCharacters:"Jmno webu obsahuje nepovolen znaky. Povolen znaky jsou a-z, ,  a , sla, mezery a pomlky."}},NotLoggedView:{text:"Ped pouitm funkce pro vkldn je teba se pihlsit.",signup:"Pihlen",signupUrl:"/web/en/login",register:"Registrace",registerUrl:"/web/en/login?p_p_id=58&p_p_lifecycle=1&p_p_state=maximized&p_p_mode=view&p_p_col_id=column-1&p_p_col_count=1&saveLastPath=0&_58_struts_action=%2Flogin%2Fcreate_account"},StartView:{text:"Zobrazen mapy, kter jste prv vytvoili na svm webu nebo webu vaeho zamstnavatele, mete vloit.",touLink:"Zobraz Podmnky pro pouit vloench map",layerlist_title:"Vkladateln mapov vrstvy",layerlist_empty:"Mapov vrstvy, kter jste vybrali, nelze vloit| Menu Vybran mapov vrstvy zobrazuje, zda vrstva me nebo neme bt vloena.",layerlist_denied:"Neme bt vloena",denied_tooltip:"Poskytovatel tchto mapovch dat nepovoluj publikaci tchto materil na jinch webech. Ped vloenm zkontrolujte prva k publikovn i menu Vybran mapov vrstvy.",buttons:{"continue":"Pokrauj",continueAndAccept:"Pijmte Podmnky pro pouit a pokraujte",cancel:"Storno",close:"Zavt"},tou:{notfound:"Podmnky pro pouit nelze nalzt",reject:"Odmtm",accept:"Pijmm"}},layer:{show:"Zobrazit",hide:"Skrt",hidden:"Mapa byla doasn skryta.",rights:{can_be_published_map_user:{label:"Publikace povolena",tooltip:"Mapov vrstva me bt publikovna ve vloenm mapovm okn a poet uivatel za tden me bt omezen."}}}}}),define("bundles/framework/bundle/publisher/locale/cs",function(){}),Oskari.registerLocalization({lang:"de",key:"Publisher",value:{title:"Karte erzeugen",flyouttitle:"Karte erzeugen",desc:"",published:{title:"Ihre Karte wurde erzeugt",desc:"Binden Sie die Karte auf Ihrer Webseite ein, indem Sie den untenstehenden HTML-Code einfgen."},edit:{popup:{title:"Eingebundene Karte wird bearbeitet",msg:"Die Daten einer zuvor eingebundenen Karte werden aktualisiert"}},BasicView:{title:"Karte einbinden",titleEdit:"Eingebundene Karte bearbeiten",domain:{title:"Webseite auf der die Karte eingebunden werden soll",label:"Webseite auf der die Karte eingebunden werden soll",placeholder:'Ohne den Prfix "http" und/oder "www"',tooltip:'Geben Sie den Namen der Indexseite Ihrer Webseite an, z.B. ihren Domain-Namen ohne den Prfix "http" und/oder "www", oder die Adresse einer Unterseite. Beispielsweise: meineWebseite.de'},name:{label:"Der Name der Karte",placeholder:"required",tooltip:"Geben Sie Ihrer Karte einen beschreibenden Namen. Bitte beachten Sie die Sprache der Benutzeroberflche."},language:{label:"Sprache",options:{fi:"Finnisch",sv:"Schwedisch",en:"Englisch",de:"Deutsch",es:"Spanisch",cs:"Tschechisch"},tooltip:"Whlen Sie die Sprache der Benutzeroberflche und Kartendaten."},size:{label:"Gre",tooltip:"Whlen oder definieren Sie die Gre der Karte, die auf Ihrer Webseite eingebunden werden soll. Die Kartenvorschau wird in der gewhlten Gre angezeigt."},tools:{label:"Werkzeuge",tooltip:"Whlen Sie die Werkzeuge, die fr die Karte verfgbar sein sollen. Deren Anordnung wird in der Kartenvorschau angezeigt.",ScaleBarPlugin:"Mastab",IndexMapPlugin:"bersichtskarte",PanButtons:"Verschiebe-Funktion",Portti2Zoombar:"Mastabs-Scrollbalken",ControlsPlugin:"Verschieben nach",SearchPlugin:"Suche nach Adresse und Ortsname",GetInfoPlugin:"Ortsdaten-Abfrage"},toollayout:{label:"Tool layout",tooltip:"Choose a layout for the tools shown on the map",lefthanded:"Lefthanded",righthanded:"Righthanded",userlayout:"Move tools",usereditmode:"Switch edit mode on",usereditmodeoff:"Switch edit mode off"},data:{label:"Statistics",tooltip:"Show the data related to map.",grid:"Show statistic grid"},layers:{label:"Kartenebenen",defaultLayer:"(Standardebene)",useAsDefaultLayer:"Als Standardebene verwenden"},sizes:{small:"Klein",medium:"Mittel",large:"Gro",custom:"Benutzerdefinierte Gre",width:"Breite",height:"Hhe"},buttons:{save:"Speichern",saveNew:"Speichern unter",ok:"OK",replace:"Ersetzen",cancel:"Abbrechen",add:"Kartenbenen hinzufgen"},confirm:{replace:{title:"Mchten Sie die eingebundene Karte ersetzen?",msg:'Klicken Sie "Ersetzen", um die nderungen sofort auf der eingebundenen Karte anzuzeigen. Es ist nicht notwendig, den HTML-Code erneut auf Ihrer Webseite einzufgen.'}},layerselection:{label:"Zeige die Kartenebenen im Men",info:"Whlen Sie Ihre Hintergrundkarten. Im Vorschaufenster knnen Sie eine Hintergrundkarte als Standard festlegen.",tooltip:"Die Hintergrundkarte wird als unterste Ebene der Karte angezeigt. Wenn Sie mehrere Hintergrundkarten ausgewhlt haben, ist nur eine Hintergrundkarte sichtbar, Sie knnen zwischen diesen wechseln.  Im Vorschaufenster knnen Sie eine Hintergrundkarte als Standard festlegen.",promote:"Luftbilder anzeigen?"},preview:"Vorschau der Karte, die eingebunden werden soll.",location:"Ort und Zoomstufe",zoomlevel:"Zoomstufe",help:"Hilfe",error:{title:"Fehler!",size:"Fehler in der Grendefinition",domain:"Die Webseite ist eine notwendige Angabe.",domainStart:'Bitte entfernen Sie den Prfix "http" und/oder "www" aus dem Namen der Webseite.',name:"Der Name ist eine notwendige Angabe.",nohelp:"Es ist keine Hilfe verfgbar",saveFailed:"Das Verffentlichen der Karte ist fehlgeschlagen. Bitte versuchen Sie es spter noch einmal.",nameIllegalCharacters:"Der Name enthlt unzulssige Zeichen. Erlaubte Zeichen sind die Buchstaben a-z, , ,  sowie Zahlen, Bindestriche und die Backspace-Taste.",domainIllegalCharacters:"Der Name der Webseite enthlt unzulssige Zeichen. Erlaubte Zeichen sind die Buchstaben a-z, , ,  sowie Zahlen, Bindestriche und die Backspace-Taste."}},NotLoggedView:{text:"Sie mssen sich anmelden, bevor Sie etwas einbinden knnen.",signup:"Anmelden",signupUrl:"/web/en/login",register:"Registrieren",registerUrl:"/web/en/login?p_p_id=58&p_p_lifecycle=1&p_p_state=maximized&p_p_mode=view&p_p_col_id=column-1&p_p_col_count=1&saveLastPath=0&_58_struts_action=%2Flogin%2Fcreate_account"},StartView:{text:"Sie knnen die gerade von Ihnen erzeugte Kartenansicht auf einer Webseite einbinden.",touLink:"Zeige die Nutzungsbedingungen fr eingebundene Karten",layerlist_title:"Kartenebenen, die eingebunden werden knnen",layerlist_empty:'Die von Ihnen ausgewhlten Kartenebenen knnen nicht eingebunden werden. Das Men "Ausgewhlte Kartenebenen" zeigt an, ob eine Kartenebene eingebunden werden kann oder nicht.',layerlist_denied:"Kann nicht eingebunden werden",denied_tooltip:'Der Kartenanbieter hat keine Erlaubnis erteilt, diese Daten auf anderen Webseiten zu verffentlichen. Prfen Sie die Verffentlichungsrechte im Men "Ausgewhlte Kartenebenen".',buttons:{"continue":"Fortfahren",continueAndAccept:"Nutzungsbedingungen akzeptieren und fortfahren",cancel:"Abbrechen",close:"Schlieen"},tou:{notfound:"Nutzungsbedingungen knnen nicht gefunden werden",reject:"Verweigern",accept:"Akzeptieren"}},layer:{show:"Zeige",hide:"Verberge",hidden:"Diese Karte wurde vorbergehend ausgeblendet.",rights:{can_be_published_map_user:{label:"Verffentlichung erlaubt",tooltip:"Die Kartenebene darf mit einer eventuellen Begrenzung der Nutzeranzahl pro Woche in einem eingebundenen Kartenfenster verffentlicht werden."}}}}}),define("bundles/framework/bundle/publisher/locale/de",function(){}),Oskari.registerLocalization({lang:"es",key:"Publisher",value:{title:"Crear mapa",flyouttitle:"Crear mapa",desc:"",published:{title:"Se ha creado su mapa",desc:"Incorpore su mapa aadiendo el siguiente cdigo HTML a tu portal web."},edit:{popup:{title:"Editando el mapa incorporado",msg:"Se estn actualizando los datos de un mapa incorporado anteriormente"}},BasicView:{title:"Mapa incorporado",titleEdit:"Editar mapa incorporado",domain:{title:"Pgina web donde se incorporar el mapa",label:"Portal web donde se incorporar el mapa",placeholder:"sin los prefijos http o www",tooltip:"Escribe el nombre de la pgina inicial de tu portal web, es decir, su dominio sin los prefijos http o www, o la direccin de una subpgina. Ejemplo: mipaginainicial.com"},name:{label:"El nombre del mapa",placeholder:"required",tooltip:"Asigne a su mapa un nombre descriptivo. Por favor, tenga en cuenta el idioma de la interfaz de usuario."},language:{label:"Idioma",options:{fi:"Finlands",sv:"Sueco",en:"Ingls",de:"Alemn",es:"Espaol",cs:"Checo"},tooltip:"Seleccione el idioma de la interfaz y de los datos del mapa."},size:{label:"Tamao",tooltip:"Seleccione o defina el tamao del mapa que se incorporar en su portal web. La previsualizacin del mapa se mostrar en el tamao seleccionado."},tools:{label:"Herramientas",tooltip:"Seleccione las herramientras que se mostrarn en el mapa. Su ubicacin se mostrar en la previsualizacin del mapa.",ScaleBarPlugin:"Escala",IndexMapPlugin:"Mapa ndice",PanButtons:"Herramienta de desplazamiento",Portti2Zoombar:"Barra de escala",ControlsPlugin:"Desplazamiento",SearchPlugin:"Bsqueda de sitios y direcciones",GetInfoPlugin:"Herramienta de consulta para los datos de sitios"},toollayout:{label:"Tool layout",tooltip:"Choose a layout for the tools shown on the map",lefthanded:"Lefthanded",righthanded:"Righthanded"},data:{label:"Statistics",tooltip:"Show the data related to map.",grid:"Show statistic grid"},layers:{label:"Capas",defaultLayer:"(Capa por defecto)",useAsDefaultLayer:"Usar como capa por defecto"},sizes:{small:"Pequeo",medium:"Mediano",large:"Grande",custom:"Tamao personalizado",width:"ancho",height:"alto"},buttons:{save:"Guardar",saveNew:"Guardar nuevo",ok:"Hecho",replace:"Reemplazar",cancel:"Cancelar",add:"aadir capa"},confirm:{replace:{title:"Desea reemplazar el mapa incorporado?",msg:"Use reemplazar para mostrar instantneamente los cambios en el mapa incorporado. No es necesario aadir de nuevo el cdigo html a su portal web."}},layerselection:{label:"Mostrar las capas en el men",info:"Seleccione los mapas de fondo. Puede configurar el mapa de fondo en la ventana de previsualizacin del mapa.",tooltip:"El mapa de fondo se muestra como la capa de fondo del mapa. Cuando seleccione las capas que va a utilizar como fondo, slo una es visible cada vez, pudiendo intercambiarlas. Puede configurar el mapa de fondo por defecto en la previsualizacin del mapa.",promote:"Mostrar imgenes por defecto?"},preview:"Previsualizacin del mapa a incorporar.",location:"Localizacin y nivel de zoom",zoomlevel:"Nivel de zoom",help:"Ayuda",error:{title:"Error!",size:"Error en la definicin del tamao",domain:"Es necesaria la informacin del portal web",domainStart:"Omitir los prefijos http o www en el nombre del portal web",name:"Es necesaria la informacin del nombre",nohelp:"No hay ayuda disponible",saveFailed:"Fallo en la publicacin del mapa. Intntelo ms tarde.",nameIllegalCharacters:"El nombre contiene caracteres no permitidos. Los caracteres permitidos son las letras entre a-z, los nmeros, los espacios en blanco y los guiones.",domainIllegalCharacters:"El nombre del portal web contiene caracteres no permitidos. Los caracteres permitidos son las letras entre a-z, los nmeros, los espacios en blanco y los guiones."}},NotLoggedView:{text:"Necesitas identificarte antes de utilizar las funciones de incrustacin.",signup:"Acceder",signupUrl:"/web/en/login",register:"Registrarse",registerUrl:"/web/en/login?p_p_id=58&p_p_lifecycle=1&p_p_state=maximized&p_p_mode=view&p_p_col_id=column-1&p_p_col_count=1&saveLastPath=0&_58_struts_action=%2Flogin%2Fcreate_account"},StartView:{text:"Puede incorporar la vista que acaba de crear en su propio portal web o en el portal de su empresa.",touLink:"Mostrar los trminos de uso para los mapas incrustados",layerlist_title:"Capas incorporables",layerlist_empty:"Las capas que ha seleccionado no pueden incorporarse. El men Capas seleccionadas muestra si una capa puede o no puede incorporarse.",layerlist_denied:"No puede incorporarse",denied_tooltip:"Los proveedores de los datos del mapa no han concedido el permiso para publicar este material en otros portales web. Comprueba los derechos de publicacin en el men Capas seleccionadas antes de la incorporacin.",buttons:{"continue":"Continuar",continueAndAccept:"Aceptar los trminos de uso y continuar",cancel:"Cancelar",close:"Cerrar"},tou:{notfound:"No se puede encontrar los trminos de uso",reject:"Rechazar",accept:"Aceptar"}},layer:{show:"Mostrar",hide:"Ocultar",hidden:"Se ha ocultado el mapa temporalmente.",rights:{can_be_published_map_user:{label:"Publicacin permitida",tooltip:"La capa puede publicarse en un visualizador incorporado y el nmero de usuarios semanales puede limitarse."}}}}}),define("bundles/framework/bundle/publisher/locale/es",function(){}),define("src/framework/publisher/module",["oskari","jquery","bundles/framework/bundle/publisher/instance","bundles/framework/bundle/publisher/Flyout","bundles/framework/bundle/publisher/Tile","bundles/framework/bundle/publisher/event/MapPublishedEvent","bundles/framework/bundle/publisher/event/ToolStyleChangedEvent","bundles/framework/bundle/publisher/event/ColourSchemeChangedEvent","bundles/framework/bundle/publisher/event/FontChangedEvent","bundles/framework/bundle/publisher/view/NotLoggedIn","bundles/framework/bundle/publisher/view/StartView","bundles/framework/bundle/publisher/view/BasicPublisher","bundles/framework/bundle/publisher/view/PublisherLocationForm","bundles/framework/bundle/publisher/view/PublisherLayerForm","bundles/framework/bundle/publisher/view/PublisherLayoutForm","css!resources/framework/bundle/publisher/css/style.css","bundles/framework/bundle/publisher/request/PublishMapEditorRequest","bundles/framework/bundle/publisher/request/PublishMapEditorRequestHandler","bundles/framework/bundle/publisher/locale/fi","bundles/framework/bundle/publisher/locale/sv","bundles/framework/bundle/publisher/locale/en","bundles/framework/bundle/publisher/locale/cs","bundles/framework/bundle/publisher/locale/de","bundles/framework/bundle/publisher/locale/es"],function(e,t){return e.bundleCls("publisher").category({create:function(){var t=this,n=e.clazz.create("Oskari.mapframework.bundle.publisher.PublisherBundleInstance");return n},update:function(e,t,n,r){}})}),requirejs.s.contexts._.nextTick=function(e){e()},require(["css"],function(e){e.setBuffer("div.notLoggedIn {\r\n  padding: 10px; }\r\n\r\n\r\n#contentMap.mapPublishMode {\r\n  margin-left: 365px; }\r\n\r\ndiv.publisher div.startview div.icon-info, div.basic_publisher div.icon-info {\r\n  float: right; }\r\n\r\ndiv.publisher div.startview div.content {\r\n  margin-top: 5px; }\r\n\r\ndiv.publisher div.startview div.tou {\r\n  margin: 15px 0; }\r\n\r\ndiv.publisher div.startview div.layerlist {\r\n  border: 1px solid;\r\n  padding: 10px; }\r\n\r\ndiv.publisher div.startview div.layerlist h4 {\r\n  font-size: 14px;\r\n  line-height: 15px;\r\n  padding-bottom: 5px; }\r\n\r\ndiv.publisher div.startview ul {\r\n  list-style: disc inside none;\r\n  padding: 5px; }\r\n\r\ndiv.publisher div.startview div.error ul li {\r\n  color: red; }\r\n\r\n#contentMap div.basic_publisher {\r\n  background: white;\r\n  position: absolute;\r\n  height: 100%;\r\n  top: 0;\r\n  left: 40px;\r\n  /* sidebar has 3, we want to open it on top of this */\r\n  z-index: 2;\r\n  width: 365px; }\r\n\r\n#contentMap div.basic_publisher div.content {\r\n  padding: 10px; }\r\n\r\ndiv.basic_publisher > div.header {\r\n  background-color: #FDF8D9;\r\n  padding: 5px 10px; }\r\n\r\ndiv.basic_publisher > div.header div.icon-close {\r\n  float: right; }\r\n\r\ndiv.basic_publisher div.customsize input {\r\n  width: 40px; }\r\n\r\ndiv.basic_publisher div.customsize input.error {\r\n  border: 1px solid red; }\r\n\r\ndiv.basic_publisher div.form div.field input, div.field select {\r\n  width: 100%;\r\n  width: 80%0/;\r\n  /* unquote for libsass bug */\r\n  background-color: white0/;\r\n  /* unquote for libsass */\r\n  filter: Alpha(opacity=100)0/ !important;\r\n  font-weight: bolder; }\r\n\r\ndiv.basic_publisher > div.content {\r\n  overflow: auto;\r\n  height: 89%; }\r\n\r\ndiv.basic_publisher div.tool {\r\n  margin: 5px; }\r\n\r\ndiv.basic_publisher div.tool-options {\r\n  padding-left: 23px; }\r\n\r\ndiv.basic_publisher div.tool input, div.basic_publisher div.data input {\r\n  margin-right: 10px; }\r\n\r\n/* Buttons */\r\ndiv.basic_publisher div.buttons, div.publisher div.startview div.buttons {\r\n  text-align: center;\r\n  margin-top: 10px; }\r\n\r\ndiv.basic_publisher div.buttons input, div.publisher div.startview div.buttons input {\r\n  margin: 5px 2px; }\r\n\r\n/* Layout */\r\ndiv.basic_publisher div#publisher-layout-colours input[name=publisher-colour] {\r\n  width: 125px; }\r\ndiv.basic_publisher p#publisher-selected-colour {\r\n  display: inline; }\r\ndiv.basic_publisher button#publisher-colours {\r\n  float: right; }\r\n\r\ndiv#publisher-colour-inputs {\r\n  margin-bottom: 15px; }\r\n\r\ndiv#publisher-custom-colours {\r\n  padding: 10px 20px; }\r\n\r\ndiv#publisher-custom-colours div#publisher-custom-colours-bg, div#publisher-custom-colours div#publisher-custom-colours-title, div#publisher-custom-colours div#publisher-custom-colours-header, div#publisher-custom-colours div#publisher-custom-colours-iconcls {\r\n  margin-bottom: 12px; }\r\n\r\ndiv#publisher-custom-colours div.rgbInput {\r\n  padding: 5px;\r\n  border: 1px solid black; }\r\n\r\ndiv#publisher-custom-colours div.rgbInput input[type=\"text\"] {\r\n  margin: 0 8px;\r\n  width: 30px; }\r\n\r\n.maincontainer ul.selectedLayersList {\r\n  margin-left: 0px; }\r\n  .maincontainer ul.selectedLayersList li {\r\n    list-style: none; }\r\n\r\ndiv.basic_publisher .layer.selected {\r\n  border: 1pt solid #c0d0e0;\r\n  margin: 0 5px 5px 0;\r\n  height: 70px9;\r\n  /*IE9 */ }\r\n  div.basic_publisher .layer.selected.out-of-scale, div.basic_publisher .layer.selected.out-of-content, div.basic_publisher .layer.selected.hidden {\r\n    color: #909090; }\r\n  div.basic_publisher .layer.selected div.layer-info {\r\n    background-color: #FFF;\r\n    padding: 5px; }\r\n    div.basic_publisher .layer.selected div.layer-info div.layer-title {\r\n      display: inline; }\r\n      div.basic_publisher .layer.selected div.layer-info div.layer-title h4 {\r\n        font: 10pt Arial, sans-serif;\r\n        padding: 0; }\r\n    div.basic_publisher .layer.selected div.layer-info div.layer-tool-remove {\r\n      float: right; }\r\n  div.basic_publisher .layer.selected div.layer-tools {\r\n    background-color: #f3f3f3;\r\n    padding: 7px; }\r\n    div.basic_publisher .layer.selected div.layer-tools div.layout-slider {\r\n      width: 140px;\r\n      display: inline-block;\r\n      margin-right: 16px; }\r\n    div.basic_publisher .layer.selected div.layer-tools div.left-tools {\r\n      display: inline-block; }\r\n      div.basic_publisher .layer.selected div.layer-tools div.left-tools div.layer-visibility {\r\n        padding-right: 5px;\r\n        display: inline-block; }\r\n      div.basic_publisher .layer.selected div.layer-tools div.left-tools div.layer-opacity {\r\n        display: inline-block;\r\n        background-image: url('/Oskari/resources/framework/bundle/layerselection2/images/opacity_slider.png');\r\n        background-repeat: no-repeat; }\r\n        div.basic_publisher .layer.selected div.layer-tools div.left-tools div.layer-opacity input.opacity {\r\n          padding: 1px;\r\n          width: 25px; }\r\n    div.basic_publisher .layer.selected div.layer-tools div.right-tools {\r\n      padding-top: 5px;\r\n      float: right; }\r\n      div.basic_publisher .layer.selected div.layer-tools div.right-tools div {\r\n        float: left;\r\n        margin-right: 5px; }\r\n        div.basic_publisher .layer.selected div.layer-tools div.right-tools div.layer-rights, div.basic_publisher .layer.selected div.layer-tools div.right-tools div.object-data {\r\n          padding-top: 2px; }\r\ndiv.basic_publisher ul.selectedLayersList {\r\n  height: 100%;\r\n  width: 100%;\r\n  overflow: auto;\r\n  list-style-type: none;\r\n  padding: 0;\r\n  margin: 0; }\r\n  div.basic_publisher ul.selectedLayersList span {\r\n    position: absolute;\r\n    margin-left: -1.3em; }\r\n\r\n.maincontainer .block {\r\n  display: block; }\r\n")}),requirejs.s.contexts._.nextTick=requirejs.nextTick;